
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to atomman: Basic Support and Analysis Tools &#8212; atomman 1.2.4 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to atomman: ElasticConstants class" href="03.1._ElasticConstants_class.html" />
    <link rel="prev" title="Introduction to atomman: Running LAMMPS and the Log class" href="02.2_Running_LAMMPS_and_the_Log_class.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="03.1._ElasticConstants_class.html" title="Introduction to atomman: ElasticConstants class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="02.2_Running_LAMMPS_and_the_Log_class.html" title="Introduction to atomman: Running LAMMPS and the Log class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Introduction-to-atomman:-Basic-Support-and-Analysis-Tools">
<h1>Introduction to atomman: Basic Support and Analysis Tools<a class="headerlink" href="#Introduction-to-atomman:-Basic-Support-and-Analysis-Tools" title="Permalink to this headline">¶</a></h1>
<p><strong>Lucas M. Hale</strong>,
<a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>,
<em>Materials Science and Engineering Division, NIST</em>.</p>
<p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">Disclaimers</a></p>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">¶</a></h2>
<p>This Notebook outlines some of the other tools in atomman that provide
basic support features and simple analysis of the atomistic systems.</p>
<p><strong>Library Imports</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Standard Python libraries</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">division</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="nb">open</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>

<span class="c1"># Show atomman version</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomman version =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Show date of Notebook execution</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
atomman version = 1.2.4
Notebook executed on 2019-02-06
</pre></div></div>
</div>
<p>Construct a demonstration 2x2x2 diamond cubic silicon system</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">5.431</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]]</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="n">atype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">supersize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
64
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Elastic-constants">
<h2>2. Elastic constants<a class="headerlink" href="#2.-Elastic-constants" title="Permalink to this headline">¶</a></h2>
<p>The full elastic constants tensor for a given crystal can be represented
with the atomman.ElasticConstants class. The values in an
ElasticConstants object can be set and retrieved in a variety of formats
and transformed to other Cartesian coordinate systems.</p>
<p>See the <a class="reference external" href="03.1._ElasticConstants_class.html">03.1. ElasticConstants class Jupyter
Notebook</a> for more details and a
full description of all of the class methods.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Define an ElasticConstants object for diamond cubic silicon</span>
<span class="c1"># values taken from http://www.ioffe.ru/SVA/NSM/Semicond/Si/mechanic.html</span>
<span class="n">C11</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">16.60</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;dyn/cm^2&#39;</span><span class="p">)</span>
<span class="n">C12</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span> <span class="mf">6.40</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;dyn/cm^2&#39;</span><span class="p">)</span>
<span class="n">C44</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span> <span class="mf">7.96</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;dyn/cm^2&#39;</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">ElasticConstants</span><span class="p">(</span><span class="n">C11</span><span class="o">=</span><span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="o">=</span><span class="n">C44</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get 6x6 Cij Voigt representation of elastic constants in GPa</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cij (GPa) =&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">Cij</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cij (GPa) =
[[166.   64.   64.    0.    0.    0. ]
 [ 64.  166.   64.    0.    0.    0. ]
 [ 64.   64.  166.    0.    0.    0. ]
 [  0.    0.    0.   79.6   0.    0. ]
 [  0.    0.    0.    0.   79.6   0. ]
 [  0.    0.    0.    0.    0.   79.6]]
</pre></div></div>
</div>
</div>
<div class="section" id="3.-Relative-distances-between-atoms">
<h2>3. Relative distances between atoms<a class="headerlink" href="#3.-Relative-distances-between-atoms" title="Permalink to this headline">¶</a></h2>
<p>There are a few built-in tools for investigating the relative positions
between atoms of the same and different systems.</p>
<div class="section" id="3.1.-System.dvect()">
<h3>3.1. System.dvect()<a class="headerlink" href="#3.1.-System.dvect()" title="Permalink to this headline">¶</a></h3>
<p>The System.dvect() method computes the shortest vector(s) between two
points or list of points within the atomman.System taking into account
the System’s periodic dimensions.</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>pos_0</strong> (<em>numpy.ndarray or index</em>) Absolute Cartesian vector
position(s) to use as reference point(s). If the value can be used as
an index, then self.atoms.pos[pos_0] is taken.</li>
<li><strong>pos_1</strong> (<em>numpy.ndarray or index</em>) Absolute Cartesian vector
position(s) to find relative to pos_0. If the value can be used as
an index, then self.atoms.pos[pos_1] is taken.</li>
<li><strong>code</strong> (<em>str, optional</em>) Option for specifying which underlying
code function to use. ‘cython’ uses the version of the function built
in cython (faster). ‘python’ uses the purely python version. Default
is ‘cython’ if the code can be imported, otherwise ‘python’.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate shortest vector between atoms 1 and 60</span>
<span class="nb">print</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">dvect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 4.07325  4.07325 -4.07325]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate shortest distance between position [5., 5., 5.] and all atoms in system</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span>

<span class="n">dvects</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">dvect</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="n">pos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dvects</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[8.66025404 5.95297241 5.95297241 5.95297241 6.30856205 3.87088054
 3.87088054 3.87088054 7.08419092 6.33398788 6.33398788 3.25939281
 5.45266877 5.86626957 5.86626957 2.2175116  7.08419092 6.33398788
 3.25939281 6.33398788 5.45266877 5.86626957 2.2175116  5.86626957
 5.03701519 6.69334927 3.91218142 3.91218142 4.43455051 7.33774633
 4.93424363 4.93424363 7.08419092 3.25939281 6.33398788 6.33398788
 5.45266877 2.2175116  5.86626957 5.86626957 5.03701519 3.91218142
 6.69334927 3.91218142 4.43455051 4.93424363 7.33774633 4.93424363
 5.03701519 3.91218142 3.91218142 6.69334927 4.43455051 4.93424363
 4.93424363 7.33774633 0.7465139  4.4706471  4.4706471  4.4706471
 3.09820588 6.6163557  6.6163557  6.6163557 ]
</pre></div></div>
</div>
</div>
<div class="section" id="3.2.-displacement()">
<h3>3.2. displacement()<a class="headerlink" href="#3.2.-displacement()" title="Permalink to this headline">¶</a></h3>
<p>The atomman.displacement() function compares two systems with the same
number of atoms and calculates the vector differences between all atoms
with the same atomic id’s. The vectors returned are the shortest vectors
after taking periodic boundaries in consideration, i.e. it uses dvect().</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>system_0</strong> (<em>atomman.System</em>) The initial system to calculate
displacements from.</li>
<li><strong>system_1</strong> (<em>atomman.System</em>) The final system to calculate
displacements to.</li>
<li><strong>box_reference</strong> (<em>str or None</em>) Specifies which system’s boundary
conditions to use.<ul>
<li>‘initial’ uses system_0’s box and pbc.</li>
<li>‘final’ uses system_1’s box and pbc (Default).</li>
<li>None computes the straight difference between the positions
without accounting for periodic boundaries.</li>
</ul>
</li>
<li><strong>code</strong> (<em>str, optional</em>) Option for specifying which code version
of dvect to use (see dvect’s documentation for details).</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Copy system and randomly displace atoms</span>
<span class="n">system2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">system2</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">system2</span><span class="o">.</span><span class="n">wrap</span><span class="p">()</span>

<span class="c1"># Show displacement between the two systems</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">system2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[2.75905106e+00 1.14475124e+00 5.12165518e-01]
 [2.64923472e-02 1.53168265e+00 2.90558917e-03]
 [2.46748481e-01 2.14370969e+00 2.94364219e-01]
 [2.34490165e+00 2.67857818e+00 1.88438128e+00]
 [1.81242144e+00 3.28422654e-01 9.35034535e-01]
 [1.33503508e+00 3.06323443e-02 2.31970387e+00]
 [4.69238583e-01 1.86712264e+00 2.59244789e+00]
 [2.80223976e+00 2.41224086e-01 3.26452784e-01]
 [1.75548744e+00 2.36930872e+00 1.52227424e-01]
 [5.51281171e-01 7.25033363e-01 8.36226247e-01]
 [3.46154038e-01 1.11602906e+00 2.46437666e+00]
 [1.81076422e+00 2.09144895e+00 1.53848701e+00]
 [7.41110960e-01 1.91357341e+00 1.07409257e+00]
 [1.19223655e+00 2.27368902e+00 7.60666439e-02]
 [1.49979391e+00 1.69235495e+00 6.01548324e-01]
 [1.81245763e+00 9.78027613e-01 7.53056118e-01]
 [2.01344296e+00 2.14875085e+00 2.34954437e+00]
 [1.13964065e+00 1.85327287e+00 1.65410825e+00]
 [1.02458567e+00 2.09987666e+00 7.49619101e-01]
 [1.44835913e+00 5.25329429e-01 2.50783491e+00]
 [2.49297106e+00 1.26030128e+00 2.14295088e+00]
 [2.76333648e+00 2.85712300e-01 1.88762049e-01]
 [2.36029284e-01 1.70503269e+00 2.03221730e+00]
 [8.01323433e-01 2.33334395e+00 1.28088615e+00]
 [2.16980489e+00 8.41390310e-02 3.05872838e-01]
 [2.17721910e+00 2.64575483e+00 2.55911388e+00]
 [2.16344566e+00 7.26530694e-01 6.59417297e-03]
 [1.20227398e+00 1.97630444e+00 4.22601061e-01]
 [8.93251546e-01 1.11218244e+00 1.18107886e+00]
 [1.12658787e+00 2.72778905e+00 1.75372906e+00]
 [2.76130574e+00 2.49175939e+00 2.30759522e+00]
 [2.79828577e+00 2.55788947e+00 7.50054647e-01]
 [2.35581755e+00 4.56979260e-01 9.89670930e-01]
 [2.86709263e+00 1.52204120e-01 2.31750426e+00]
 [1.22487701e+00 2.61586323e-01 1.72434844e+00]
 [1.60086852e+00 6.20878910e-01 2.96541239e+00]
 [1.57258275e+00 3.28184496e-02 7.37780968e-01]
 [4.49329726e-01 2.19287075e+00 1.82968226e+00]
 [2.00247547e+00 1.82028777e-01 2.59826753e+00]
 [1.15267404e+00 1.09563609e+00 2.40147190e+00]
 [1.49008880e+00 9.86197464e-02 2.94456749e+00]
 [2.23075711e+00 1.38430806e+00 2.36440918e+00]
 [1.04589754e+00 2.99642292e+00 2.41973848e+00]
 [1.68809617e-01 2.01032081e+00 1.89683478e+00]
 [2.58135555e+00 1.55803884e+00 2.07027730e+00]
 [9.00979733e-01 2.80144377e+00 2.24906669e+00]
 [8.74070874e-01 4.53933814e-01 1.84514095e+00]
 [2.10114203e+00 2.74406841e-01 2.96662454e+00]
 [2.48450560e-01 1.07916549e+00 2.83718472e+00]
 [4.77651239e-01 2.34844475e-01 1.99242297e+00]
 [1.88468680e+00 1.69074815e+00 6.24277260e-01]
 [2.27669663e+00 2.01964230e+00 2.46575650e-01]
 [8.08970605e-01 1.88187786e+00 1.61581061e+00]
 [1.73227827e-01 2.24384135e+00 1.19192834e+00]
 [1.37484802e+00 7.94592414e-01 2.01221770e+00]
 [2.56700596e+00 1.95189328e+00 1.90094028e+00]
 [2.83247339e+00 1.65003693e+00 3.55661268e-01]
 [1.32775113e+00 1.18991890e+00 9.16743109e-01]
 [2.92691366e+00 9.91054873e-02 5.97476738e-01]
 [2.41617767e+00 1.03904480e+00 1.35542947e+00]
 [2.18419443e+00 2.52142539e+00 2.05512110e+00]
 [1.26394164e+00 1.99544493e+00 1.32622163e-01]
 [4.47462868e-01 1.00188702e-01 2.79629070e+00]
 [2.54428776e+00 1.35679133e+00 7.20111889e-01]]
</pre></div></div>
</div>
</div>
<div class="section" id="3.3.-System.neighborlist()">
<h3>3.3. System.neighborlist()<a class="headerlink" href="#3.3.-System.neighborlist()" title="Permalink to this headline">¶</a></h3>
<p>A list of neighbor atoms within a cutoff can be constructed using the
System.neighborlist() method. The list of neighbors is returned as an
atomman.NeighborList object.</p>
<p>See the <a class="reference external" href="03.2._NeighborList_class.html">03.2. NeighborList class Jupyter
Notebook</a> for more details on how the
list is calculated and can be used.</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>cutoff</strong> (<em>float, optional</em>) Radial cutoff distance for identifying
neighbors. Must be given if model is not given.</li>
<li><strong>model</strong> (<em>str or file-like object, optional</em>) Gives the file path
or content to load. If given, no other parameters are allowed.</li>
<li><strong>cmult</strong> (<em>int, optional</em>) Parameter associated with the binning
routine. Default value is most likely the fastest.</li>
<li><strong>code</strong> (<em>str, optional</em>) Option for specifying which underlying
code function to use. ‘cython’ uses the version of the function built
in cython (faster). ‘python’ uses the purely python version. Default
is ‘cython’ if the code can be imported, otherwise ‘python’.</li>
<li><strong>initialsize</strong> (<em>int, optional</em>) The number of neighbor positions to
initially assign to each atom. Default value is 20.</li>
<li><strong>deltasize</strong> (<em>int, optional</em>) Specifies the number of extra
neighbor positions to allow each atom when the number of neighbors
exceeds the underlying array size. Default value is 10.</li>
</ul>
<p>Returns</p>
<ul class="simple">
<li>(<em>atomman.NeighborList</em>) The compiled list of neighbors.</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Identify neighbors within 3 angstroms</span>
<span class="n">neighbors</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">neighborlist</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Show average atomic coordination</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average coordination =&#39;</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average coordination = 4.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># List neighbor atoms of atom 6</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Neighbors of atom 6 =&#39;</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Neighbors of atom 6 = [ 2 11 33 40]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.-Basic-tools">
<h2>4. Basic tools<a class="headerlink" href="#4.-Basic-tools" title="Permalink to this headline">¶</a></h2>
<p>This lists some of the other basic tools and features in atomman.</p>
<div class="section" id="4.1.-Atomic-information">
<h3>4.1. Atomic information<a class="headerlink" href="#4.1.-Atomic-information" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>atomman.tools.atomic_number()</strong> returns the atomic number
associated with an element’s atomic symbol.</li>
<li><strong>atomman.tools.atomic_symbol()</strong> returns the elemental symbol
associated with an given atomic number.</li>
<li><strong>atomman.tools.atomic_mass()</strong> returns the atomic mass of an
element or isotope. The atom can be identified with atomic number or
atomic/isotope symbol.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get atomic number for an atomic symbol</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">atomic_number</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="c1"># Get atomic symbol for an atomic number</span>
<span class="n">symbol</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">atomic_symbol</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

<span class="c1"># Get atomic mass for an atomic symbol</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">atomic_mass</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>

<span class="c1"># Get atomic mass for an atomic number</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">atomic_mass</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
26
Fe
55.845
55.845
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get atomic mass for an isotope</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">atomic_mass</span><span class="p">(</span><span class="s1">&#39;Al-26&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
25.986891904
</pre></div></div>
</div>
</div>
<div class="section" id="4.2.-axes_check()">
<h3>4.2. axes_check()<a class="headerlink" href="#4.2.-axes_check()" title="Permalink to this headline">¶</a></h3>
<p>The axes_check() function is useful when working in Cartesian systems.
Given a (3,3) array representing three 3D Cartesian vectors:</p>
<ul class="simple">
<li>The three vectors are checked that they are orthogonal and
right-handed.</li>
<li>The corresponding array of unit vectors are returned. This can then
be used for crystal transformations.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">axes</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">axes_check</span><span class="p">(</span><span class="n">axes</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-0.70710678  0.          0.70710678]
 [ 0.70710678  0.          0.70710678]
 [ 0.          1.          0.        ]]
</pre></div></div>
</div>
</div>
<div class="section" id="4.3.-filltemplate()">
<h3>4.3. filltemplate()<a class="headerlink" href="#4.3.-filltemplate()" title="Permalink to this headline">¶</a></h3>
<p>The filltemplate() function takes a template and fills in values for
delimited template variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">madlibs</span> <span class="o">=</span> <span class="s2">&quot;My friend &lt;name&gt; really likes to use templates to &lt;verb&gt;, says that they are &lt;adjective&gt;!&quot;</span>
<span class="n">s_delimiter</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span>
<span class="n">e_delimiter</span> <span class="o">=</span> <span class="s1">&#39;&gt;&#39;</span>

<span class="n">terms</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">terms</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Charlie&#39;</span>
<span class="n">terms</span><span class="p">[</span><span class="s1">&#39;verb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;program&#39;</span>
<span class="n">terms</span><span class="p">[</span><span class="s1">&#39;adjective&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;delicious&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">filltemplate</span><span class="p">(</span><span class="n">madlibs</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">s_delimiter</span><span class="p">,</span> <span class="n">e_delimiter</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
My friend Charlie really likes to use templates to program, says that they are delicious!
</pre></div></div>
</div>
</div>
<div class="section" id="4.4.-indexstr()">
<h3>4.4. indexstr()<a class="headerlink" href="#4.4.-indexstr()" title="Permalink to this headline">¶</a></h3>
<p>Iterates through all indicies of an array with a given shape, returning
both the numeric index and a string representation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">istr</span> <span class="ow">in</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">indexstr</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;index -&gt;&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="s1">&#39;, istr -&gt;&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">istr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
index -&gt; (0, 0) , istr -&gt; &#39;[0][0]&#39;
index -&gt; (0, 1) , istr -&gt; &#39;[0][1]&#39;
index -&gt; (1, 0) , istr -&gt; &#39;[1][0]&#39;
index -&gt; (1, 1) , istr -&gt; &#39;[1][1]&#39;
index -&gt; (2, 0) , istr -&gt; &#39;[2][0]&#39;
index -&gt; (2, 1) , istr -&gt; &#39;[2][1]&#39;
</pre></div></div>
</div>
</div>
<div class="section" id="4.5.-uber_open_rmode">
<h3>4.5. uber_open_rmode<a class="headerlink" href="#4.5.-uber_open_rmode" title="Permalink to this headline">¶</a></h3>
<p>uber_open_rmode is a context manager that allows for similar reading
of content from a file or from a string variable. It equivalently
handles:</p>
<ul class="simple">
<li>str path name to a file</li>
<li>str content</li>
<li>open file-like object</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Define str and save to file</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Here I am, read me!&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;text.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># Use uber_open_rmode on text</span>
<span class="k">with</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">uber_open_rmode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># Use uber_open_rmode on file path</span>
<span class="k">with</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">uber_open_rmode</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># Use uber_open_rmode on file-like object</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobject</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">uber_open_rmode</span><span class="p">(</span><span class="n">fobject</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
b&#39;Here I am, read me!&#39;
b&#39;Here I am, read me!&#39;
b&#39;Here I am, read me!&#39;
</pre></div></div>
</div>
</div>
<div class="section" id="4.6.-vect_angle()">
<h3>4.6. vect_angle()<a class="headerlink" href="#4.6.-vect_angle()" title="Permalink to this headline">¶</a></h3>
<p>The vect_angle() function returns the angle between two vectors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">vect1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">vect2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Angle between&#39;</span><span class="p">,</span> <span class="n">vect1</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">vect2</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">vect_angle</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">),</span> <span class="s1">&#39;degrees&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">vect_angle</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">,</span> <span class="s1">&#39;radian&#39;</span><span class="p">),</span> <span class="s1">&#39;radians&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Angle between [-0.54710365 -0.0745084  -0.30410803] and [ 0.72169186  0.0943178  -0.15078634] =
139.4498379401382 degrees
2.4338588134279187 radians
</pre></div></div>
</div>
</div>
<div class="section" id="4.7.-Miller-index-conversions">
<h3>4.7. Miller index conversions<a class="headerlink" href="#4.7.-Miller-index-conversions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>atomman.tools.miller.vector3to4(indices)</strong> converts three-term
Miller indices to four-term Miller-Bravais for hexagonal systems.</li>
<li><strong>atomman.tools.miller.vector4to3(indices)</strong> converts four-term
Miller-Bravais to three-term Miller indices.</li>
<li><strong>atomman.tools.miller.vectortocartesian(indices, box)</strong> converts
Miller and Miller-Bravais indices to Cartesian vectors based on a
supplied box.</li>
</ul>
<p><strong>Note</strong>: The returned indices will be the smallest integer
representations possible, i.e. direction is retained but magnitude may
be different.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Test single value case</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vector3to4</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vector4to3</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1  1 -2  3]
[1 1 0]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Generate random uvw crystal indices</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Convert to hexagonal uvtw&#39;s</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vector3to4</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Convert back to uvw&#39;s</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vector4to3</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1 -1 -2]
 [-2 -1 -3]
 [ 4  0 -3]]

[[ 1 -1  0 -2]
 [-1  0  1 -3]
 [ 8 -4 -4 -9]]

[[ 1 -1 -2]
 [-2 -1 -3]
 [ 4  0 -3]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Define a hexagonal box</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">2.51</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">4.07</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="c1"># Pass Miller indices</span>
<span class="n">indices</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vectortocartesian</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Pass equivalent Miller-Bravais indices</span>
<span class="n">indices</span> <span class="o">=</span> <span class="p">[[</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">miller</span><span class="o">.</span><span class="n">vectortocartesian</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">box</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 2.51        0.          0.        ]
 [-1.255       2.17372376  0.        ]
 [ 0.          0.          4.07      ]]

[[ 2.51        0.          0.        ]
 [-1.255       2.17372376  0.        ]
 [ 0.          0.          4.07      ]]
</pre></div></div>
</div>
</div>
<div class="section" id="4.8.-Crystal-lattice-identification">
<h3>4.8. Crystal lattice identification<a class="headerlink" href="#4.8.-Crystal-lattice-identification" title="Permalink to this headline">¶</a></h3>
<p>There are also a few tests for identifying if a supplied box is
consistent with a standard representation of a crystal family unit cell.</p>
<ul class="simple">
<li><strong>atomman.tools.identifyfamily(box)</strong> returns str crystal family if
box corresponds to a standard crystal representation. Otherwise,
returns None.</li>
<li><strong>atomman.tools.iscubic(box))</strong> returns bool indicating if box is a
standard cubic box.</li>
<li><strong>atomman.tools.ishexagonal(box))</strong> returns bool indicating if box is
a standard hexagonal box.</li>
<li><strong>atomman.tools.istetragonal(box))</strong> returns bool indicating if box
is a standard tetragonal box.</li>
<li><strong>atomman.tools.isrhombohedral(box))</strong> returns bool indicating if box
is a standard rhombohedral box.</li>
<li><strong>atomman.tools.isorthorhombic(box))</strong> returns bool indicating if box
is a standard orthorhombic box.</li>
<li><strong>atomman.tools.ismonoclinic(box))</strong> returns bool indicating if box
is a standard monoclinic box.</li>
<li><strong>atomman.tools.istriclinic(box))</strong> returns bool indicating if box is
a standard triclinic box.</li>
</ul>
<p>All of these functions use the following standard representation
criteria:</p>
<ul class="simple">
<li>cubic:<ul>
<li><span class="math">\(a = b = c\)</span></li>
<li><span class="math">\(\alpha = \beta = \gamma = 90\)</span></li>
</ul>
</li>
<li>hexagonal:<ul>
<li><span class="math">\(a = b \ne c\)</span></li>
<li><span class="math">\(\alpha = \beta = 90\)</span></li>
<li><span class="math">\(\gamma = 120\)</span></li>
</ul>
</li>
<li>tetragonal:<ul>
<li><span class="math">\(a = b \ne c\)</span></li>
<li><span class="math">\(\alpha = \beta = \gamma = 90\)</span></li>
</ul>
</li>
<li>rhombohedral:<ul>
<li><span class="math">\(a = b = c\)</span></li>
<li><span class="math">\(\alpha = \beta = \gamma \ne 90\)</span></li>
</ul>
</li>
<li>orthorhombic:<ul>
<li><span class="math">\(a \ne b \ne c\)</span></li>
<li><span class="math">\(\alpha = \beta = \gamma = 90\)</span></li>
</ul>
</li>
<li>monoclinic:<ul>
<li><span class="math">\(a \ne b \ne c\)</span></li>
<li><span class="math">\(\alpha = \gamma = 90\)</span></li>
<li><span class="math">\(\beta \ne 90\)</span></li>
</ul>
</li>
<li>triclinic:<ul>
<li><span class="math">\(a \ne b \ne c\)</span></li>
<li><span class="math">\(\alpha \ne \beta \ne \gamma\)</span></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Define an orthogonal box</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">2.51</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">3.13</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">4.07</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;identifyfamily =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">identifyfamily</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iscubic =       &#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">iscubic</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ishexagonal =   &#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">ishexagonal</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;istetragonal =  &#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">istetragonal</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;isrhombohedral =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">isrhombohedral</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;isorthorhombic =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">isorthorhombic</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ismonoclinic =  &#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">ismonoclinic</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;istriclinic =   &#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">istriclinic</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
identifyfamily = orthorhombic
iscubic =        False
ishexagonal =    False
istetragonal =   False
isrhombohedral = False
isorthorhombic = True
ismonoclinic =   False
istriclinic =    False
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Define a non-standard tetragonal box with a=c!=b</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;identifyfamily =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">identifyfamily</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
identifyfamily = None
</pre></div></div>
</div>
<p><strong>File Cleanup</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;text.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to atomman: Basic Support and Analysis Tools</a><ul>
<li><a class="reference internal" href="#1.-Introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#2.-Elastic-constants">2. Elastic constants</a></li>
<li><a class="reference internal" href="#3.-Relative-distances-between-atoms">3. Relative distances between atoms</a><ul>
<li><a class="reference internal" href="#3.1.-System.dvect()">3.1. System.dvect()</a></li>
<li><a class="reference internal" href="#3.2.-displacement()">3.2. displacement()</a></li>
<li><a class="reference internal" href="#3.3.-System.neighborlist()">3.3. System.neighborlist()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Basic-tools">4. Basic tools</a><ul>
<li><a class="reference internal" href="#4.1.-Atomic-information">4.1. Atomic information</a></li>
<li><a class="reference internal" href="#4.2.-axes_check()">4.2. axes_check()</a></li>
<li><a class="reference internal" href="#4.3.-filltemplate()">4.3. filltemplate()</a></li>
<li><a class="reference internal" href="#4.4.-indexstr()">4.4. indexstr()</a></li>
<li><a class="reference internal" href="#4.5.-uber_open_rmode">4.5. uber_open_rmode</a></li>
<li><a class="reference internal" href="#4.6.-vect_angle()">4.6. vect_angle()</a></li>
<li><a class="reference internal" href="#4.7.-Miller-index-conversions">4.7. Miller index conversions</a></li>
<li><a class="reference internal" href="#4.8.-Crystal-lattice-identification">4.8. Crystal lattice identification</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="02.2_Running_LAMMPS_and_the_Log_class.html"
                        title="previous chapter">Introduction to atomman: Running LAMMPS and the Log class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="03.1._ElasticConstants_class.html"
                        title="next chapter">Introduction to atomman: ElasticConstants class</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="03.1._ElasticConstants_class.html" title="Introduction to atomman: ElasticConstants class"
             >next</a> |</li>
        <li class="right" >
          <a href="02.2_Running_LAMMPS_and_the_Log_class.html" title="Introduction to atomman: Running LAMMPS and the Log class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>