
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Introduction to atomman: Stacking fault generator &#8212; atomman 1.4.0 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to atomman: Dislocation solution and generator" href="4.4._Dislocation_solution_and_generator.html" />
    <link rel="prev" title="Introduction to atomman: Free surface generator" href="4.2._Free_surface_generator.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="4.4._Dislocation_solution_and_generator.html" title="Introduction to atomman: Dislocation solution and generator"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="4.2._Free_surface_generator.html" title="Introduction to atomman: Free surface generator"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.4.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Introduction-to-atomman:-Stacking-fault-generator">
<h1>Introduction to atomman: Stacking fault generator<a class="headerlink" href="#Introduction-to-atomman:-Stacking-fault-generator" title="Permalink to this headline">Â¶</a></h1>
<p><strong>Lucas M. Hale</strong>, <a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>, <em>Materials Science and Engineering Division, NIST</em>.</p>
<p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">Disclaimers</a></p>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">Â¶</a></h2>
<p>This Notebook outlines the StackingFault class which generates atomic systems that can be used to evaluate stacking fault energies. See the <a class="reference external" href="4.5._Gamma_surface_plotting.html">4.5 Gamma surface plotting Notebook</a> for analysis and plotting of computed stacking fault energies.</p>
<p><em>Completely reworked for version 1.3.2</em> the new StackingFault class is a child of FreeSurface, and therefore has built-in tools for easier generation.</p>
<p>Documentation for the older StackingFault class can be found on github by exploring past versions of this Notebook.</p>
<p><strong>Library Imports</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Standard Python libraries</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>

<span class="c1"># Show atomman version</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomman version =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Show date of Notebook execution</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
atomman version = 1.4.0
Notebook executed on 2021-08-05
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Theory">
<h2>2. Theory<a class="headerlink" href="#2.-Theory" title="Permalink to this headline">Â¶</a></h2>
<p>A stacking fault atomic configuration can be constructed by</p>
<ol class="arabic simple">
<li><p>Generating a bulk crystalline system with all periodic boundaries.</p></li>
<li><p>Slicing the system along a geometrical plane creating two ideal planar-sliced free surfaces.</p></li>
<li><p>Specifying a geometrical fault plane that is parallel to the free surfaces and divides the atoms (roughly) in half.</p></li>
<li><p>Rigidly shifting all atoms on one side of the fault plane by the same shift vector, <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>.</p></li>
</ol>
<p>The first two steps correspond with the construction of a planar-sliced free surface configuration. The corresponding theory for those steps is outlined in the <a class="reference external" href="4.2._Free_surface_generator.html">Free surface configuration generator Notebook</a>.</p>
<p>Once the free surface has been constructed, a stacking fault configuration can be defined by specifying the location to position the fault plane, and a fault shift <span class="math notranslate nohighlight">\(\mathbf{d}\)</span> to apply. For the plane position, it is usually convenient to select the halfway point in the system. If the system was constructed with an even number of replicas in the direction normal to the fault/surface planes, then placing the fault plane in the middle of the system will result in the fault plane matching the
free surface plane.</p>
<p>As the fault plane can be explored in 2 dimensions, the applied shift, <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>, can be expressed using two non-parallel vectors within the fault plane, <span class="math notranslate nohighlight">\(\mathbf{a_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{a_2}\)</span>. Taking <span class="math notranslate nohighlight">\(\mathbf{a_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{a_2}\)</span> as lattice slip vectors (i.e.Â vectors between two symmetrically identical lattice sites) will define a 2D cell encompassing all possible unique stacking fault shifts for the fault plane. <span class="math notranslate nohighlight">\(\mathbf{d}\)</span> can then be represented using
fractional coordinates, <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a_2\)</span>, relative to <span class="math notranslate nohighlight">\(\mathbf{a_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{a_2}\)</span></p>
<div class="math notranslate nohighlight">
\[\mathbf{d} = a_1 \mathbf{a_1} + a_2 \mathbf{a_2}\]</div>
<p>If the free surface configuration was generated using a primitive unit cell, then the two in-plane box vectors of the intermediate rotated cell will correspond to the shortest in-plane lattice vectors. As such, using those box vectors will result in the smallest periodic 2D cell necessary to fully explore the stacking fault map.</p>
</div>
<div class="section" id="3.-Class-basics">
<h2>3. Class basics<a class="headerlink" href="#3.-Class-basics" title="Permalink to this headline">Â¶</a></h2>
<p>The class is set up to generate stacking fault configuration systems in three steps:</p>
<ol class="arabic simple">
<li><p>Initialize the class and specify the (hkl) fault/surface plane and unit cell structure to use. The proper rotated cell will be generated as well as a list of shifts that can be applied.</p></li>
<li><p>Build the free surface system by selecting the shift value corresponding to the termination planes of interest and the size of the final system.</p></li>
<li><p>Construct stacking fault configurations by rigidly shifting all atoms on one side of the fault plane.</p></li>
</ol>
<div class="section" id="3.1.-StackingFault-initialization">
<h3>3.1. StackingFault initialization<a class="headerlink" href="#3.1.-StackingFault-initialization" title="Permalink to this headline">Â¶</a></h3>
<p>Class initializer. Identifies the proper rotations for the given hkl plane and cutboxvector, and creates the rotated cell.</p>
<ul class="simple">
<li><p><strong>hkl</strong> (<em>array-like object</em>) The free surface plane to generate expressed in either 3 indices Miller (hkl) format or 4 indices Miller-Bravais (hkil) format.</p></li>
<li><p><strong>ucell</strong> (<em>atomman.System</em>) The unit cell to use in generating the system.</p></li>
<li><p><strong>cutboxvector</strong> (<em>str, optional</em>) Specifies which of the three box vectors corresponds to the out-of-plane vector. Default value is c.</p></li>
<li><p><strong>maxindex</strong> (<em>int, optional</em>) Max uvw index value to use in identifying the best uvw set for the out-of-plane vector. If not given, will use the largest absolute index between the given hkl and the initial in-plane vector guesses.</p></li>
<li><p><strong>a1vect_uvw</strong> (<em>array-like object, optional</em>) The crystal vector to use for one of the two shifting vectors. If not given, will be set to the shortest in-plane box vector of rcell.</p></li>
<li><p><strong>a2vect_uvw</strong> (<em>array-like object, optional</em>) The crystal vector to use for one of the two shifting vectors. If not given, will be set to the other in-plane box vector of rcell.</p></li>
<li><p><strong>conventional_setting</strong> (<em>str, optional</em>) Allows for rotations of a primitive unit cell to be determined from (hkl) indices specified relative to a conventional unit cell. Allowed settings: âpâ for primitive (no conversion), âfâ for face-centered, âiâ for body-centered, and âaâ, âbâ, or âcâ for side-centered. Default behavior is to perform no conversion, i.e.Â take (hkl) relative to the given ucell.</p></li>
<li><p><strong>tol</strong> (<em>float, optional</em>) Tolerance parameter used to round off near-zero values. Default value is 1e-8.</p></li>
</ul>
</div>
<div class="section" id="3.2.-StackingFault.surface()">
<h3>3.2. StackingFault.surface()<a class="headerlink" href="#3.2.-StackingFault.surface()" title="Permalink to this headline">Â¶</a></h3>
<p>Generates the free surface atomic system, which is used as the basis for generating the stacking fault configuration(s).</p>
<ul class="simple">
<li><p><strong>shift</strong> (<em>array-like object, optional</em>) Applies a shift to all atoms. Different values allow for free surfaces with different termination planes to be selected.</p></li>
<li><p><strong>vacuumwidth</strong> (<em>float, optional</em>) If given, the free surface is created by modifying the systemâs box to insert a region of vacuum with this width. This is typically used for DFT calculations where it is computationally preferable to insert a vacuum region and keep all dimensions periodic.</p></li>
<li><p><strong>sizemults</strong> (<em>list or tuple, optional</em>) The three System.supersize multipliers [a_mult, b_mult, c_mult] to use on the rotated cell to build the final system. Note that the cutboxvector sizemult must be an integer and not a tuple. Default value is [1, 1, 1].</p></li>
<li><p><strong>minwidth</strong> (<em>float, optional</em>) If given, the sizemult along the cutboxvector will be selected such that the width of the resulting final system in that direction will be at least this value. If both sizemults and minwidth are given, then the larger of the two in the cutboxvector direction will be used.</p></li>
<li><p><strong>even</strong> (<em>bool, optional</em>) A True value means that the sizemult for cutboxvector will be made an even number by adding 1 if it is odd. Default value is False.</p></li>
<li><p><strong>faultpos_rel</strong> (<em>float, optional</em>) The position to place the slip plane within the system given as a relative coordinate along the out-of-plane direction. faultpos_rel and faultpos_cart cannot both be given. Default value is 0.5 if faultpos_cart is also not given.</p></li>
<li><p><strong>faultpos_cart</strong> (<em>float, optional</em>) The position to place the slip plane within the system given as a Cartesian coordinate along the out-of-plane direction. faultpos_rel and faultpos_cart cannot both be given.</p></li>
</ul>
</div>
<div class="section" id="3.3.-StackingFault.fault()">
<h3>3.3. StackingFault.fault()<a class="headerlink" href="#3.3.-StackingFault.fault()" title="Permalink to this headline">Â¶</a></h3>
<p>Generates a fault configuration by displacing all atoms above the slip plane.</p>
<p>Parameters</p>
<ul class="simple">
<li><p><strong>a1</strong> (<em>float, optional</em>) The fractional coordinate of a1vect to shift by. Default value is 0.0.</p></li>
<li><p><strong>a2</strong> (<em>float, optional</em>) The fractional coordinate of a2vect to shift by. Default value is 0.0.</p></li>
<li><p><strong>outofplane</strong> (<em>float, optional</em>) An out-of-plane shift, given in absolute units. Default value is 0.0.</p></li>
<li><p><strong>faultshift</strong> (<em>array-like object, optional</em>) The full shifting vector to displace the atoms above the slip plane by. Cannot be given with a1, a2, or outofplane.</p></li>
<li><p><strong>minimum_r</strong> (<em>float, optional</em>) <em>Added version 1.2.7</em> Specifies the minimum allowed interatomic spacing across the slip plane. If any sets of atoms are closer than this value then the outofplane shift is increased. Default value is None, which performs no adjustment.</p></li>
</ul>
<p>Returns</p>
<ul class="simple">
<li><p>(<em>atomman.System</em>) The atomic configuration with stacking fault shift</p></li>
</ul>
</div>
<div class="section" id="3.4.-StackingFault.iterfaultmap()">
<h3>3.4. StackingFault.iterfaultmap()<a class="headerlink" href="#3.4.-StackingFault.iterfaultmap()" title="Permalink to this headline">Â¶</a></h3>
<p>Iterates over generalized stacking fault configurations associated with a 2D map of equally spaced a1, a2 coordinates.</p>
<p>Parameters</p>
<ul class="simple">
<li><p><strong>num_a1</strong> (<em>int</em>) The number of a1 values to generate systems for. Default value is 1 (only generate for a1=0.0).</p></li>
<li><p><strong>num_a2</strong> (<em>int</em>) The number of a2 values to generate systems for. Default value is 1 (only generate for a2=0.0).</p></li>
<li><p><strong>outofplane</strong> (<em>float, optional</em>) An out-of-plane shift, given in absolute units. Default value is 0.0.</p></li>
<li><p><strong>minimum_r</strong> (<em>float, optional</em>) <em>Added version 1.2.7</em> Specifies the minimum allowed interatomic spacing across the slip plane. If any sets of atoms are closer than this value then the outofplane shift is increased. Default value is None, which performs no adjustment.</p></li>
</ul>
<p>Yields</p>
<ul class="simple">
<li><p><strong>a1</strong> (<em>float</em>) The a1 fractional coordinate of a1vect.</p></li>
<li><p><strong>a2</strong> (<em>float</em>) The a2 fractional coordinate of a2vect.</p></li>
<li><p>(<em>atomman.System</em>) The fault configuration associated with the a1, a2 shift.</p></li>
</ul>
</div>
</div>
<div class="section" id="4.-Examples">
<h2>4. Examples<a class="headerlink" href="#4.-Examples" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="4.1.-fcc-\{111\}">
<h3>4.1. fcc <span class="math notranslate nohighlight">\(\{111\}\)</span><a class="headerlink" href="#4.1.-fcc-\{111\}" title="Permalink to this headline">Â¶</a></h3>
<div class="section" id="4.1.1.-Define-an-fcc-conventional-cell-and-initialize-a-StackingFault">
<h4>4.1.1. Define an fcc conventional cell and initialize a StackingFault<a class="headerlink" href="#4.1.1.-Define-an-fcc-conventional-cell-and-initialize-a-StackingFault" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">4.05</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">cubic</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plane_hkl</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]</span>

<span class="n">sf</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">StackingFault</span><span class="p">(</span><span class="n">plane_hkl</span><span class="p">,</span> <span class="n">ucell</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.1.2.-Check-the-identified-rotated-system">
<h4>4.1.2. Check the identified rotated system<a class="headerlink" href="#4.1.2.-Check-the-identified-rotated-system" title="Permalink to this headline">Â¶</a></h4>
<p>The StackingFault class is a child of FreeSurface, so it has all the same attributes that you can check. In addition, default values of a1vect and a2vect are set during the class initialization.</p>
<ul class="simple">
<li><p><strong>uvws</strong> are the three conventional Miller vectors used as the box vectors of the rotated system.</p></li>
<li><p><strong>rcell</strong> is the rotated cell.</p></li>
<li><p><strong>transform</strong> is the Cartesian transformation matrix associated with going from ucell to rcell.</p></li>
<li><p><strong>rcellwidth</strong> is the width of the rotated cell in the direction normal to the hkl plane.</p></li>
<li><p><strong>a1vect_uvw, a2vect_uvw</strong> are the two lattice fault vectors as crystallographic Miller vectors relative to ucell.</p></li>
<li><p><strong>a1vect_cart, a2vect_cart</strong> are the two lattice fault vectors as Cartesian vectors relative to rcell.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">uvws</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-1.  1.  0.]
 [-1.  0.  1.]
 [ 1.  1.  1.]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">rcell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 5.728,  0.000,  0.000]
bvect =  [ 2.864,  4.960,  0.000]
cvect =  [ 0.000,  0.000,  7.015]
origin = [ 0.000,  0.000,  0.000]
natoms = 12
natypes = 1
symbols = (&#39;Al&#39;,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   5.728 |   4.960 |   0.000
      1 |       1 |   7.159 |   2.480 |   0.000
      2 |       1 |   4.296 |   2.480 |   0.000
      3 |       1 |   8.591 |   4.960 |   0.000
      4 |       1 |   1.432 |   0.827 |   2.338
      5 |       1 |   4.296 |   0.827 |   2.338
      6 |       1 |   2.864 |   3.307 |   2.338
      7 |       1 |   5.728 |   3.307 |   2.338
      8 |       1 |   5.728 |   1.653 |   4.677
      9 |       1 |   4.296 |   4.134 |   4.677
     10 |       1 |   7.159 |   4.134 |   4.677
     11 |       1 |   2.864 |   1.653 |   4.677
</pre></div></div>
</div>
<p>The default a1vect_uvw and a2vect_uvw values are the two in-plane uvw rotation vectors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The crystal shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Cartesian shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_cart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The crystal shift vectors:
[-1.  1.  0.]
[-1.  0.  1.]
The Cartesian shift vectors:
[ 5.72756493e+00 -5.57532102e-16 -8.29754091e-16]
[ 2.86378246e+00  4.96021673e+00 -8.29754091e-16]
</pre></div></div>
</div>
<p>As the StackingFault class was initialized with the conventional unit cell, the default shifting vectors are not the smallest possible lattice vectors. The shift values can be manually set either 1. during initialization, 2. by setting to the a1vect_uvw, a2vect_uvw attributes after initialization, or 3. when calling one of the fault configuration generation methods.</p>
<p>Note: the choice below is the most optimum for fcc {111} planes as the two shift vectors are the smallest non-parallel in-plane lattice vectors. The typical fcc {111} representation seen in papers with shifts of <span class="math notranslate nohighlight">\(\frac{1}{2}[\bar{1}10]\)</span> and <span class="math notranslate nohighlight">\(\frac{1}{2}[11\bar{2}]\)</span> vectors is actually a double cell and therefore requires sampling twice the area. The GammaSurface class accounts for periodicity, meaning that the standard representation can be plotted based on measured results from the
optimum grid of shifts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_uvw</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">sf</span><span class="o">.</span><span class="n">a2vect_uvw</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The crystal shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Cartesian shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_cart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The crystal shift vectors:
[-0.5  0.5  0. ]
[-0.5  0.   0.5]
The Cartesian shift vectors:
[ 2.86378246e+00 -2.78766051e-16 -4.14877046e-16]
[ 1.43189123e+00  2.48010836e+00 -4.14877046e-16]
</pre></div></div>
</div>
</div>
<div class="section" id="4.1.3.-Build-the-free-surface-configuration">
<h4>4.1.3. Build the free surface configuration<a class="headerlink" href="#4.1.3.-Build-the-free-surface-configuration" title="Permalink to this headline">Â¶</a></h4>
<p>The stacking fault configurations are modifications of the free surface configuration, so the next step is to build the free surface system. For stacking fault configurations, two different parallel geometrical planes need to be positioned inside the system: the free surface cut plane and the fault plane. Their positioning with respect to the atomic system is controlled by</p>
<ul class="simple">
<li><p><strong>shift</strong> rigidly shifts the atoms. This is best used to position the cut plane</p></li>
<li><p><strong>faultpos_rel, faultpos_cart</strong> position the fault plane in the shifted system either at a relative coordinate or an absolute Cartesian coordinate, respectively.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">shifts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0.         0.         1.1691343 ]
 [0.         0.         3.50740289]
 [0.         0.         5.84567148]]
</pre></div></div>
</div>
<p>When building the free surface configuration, the default fault position corresponds to faultpos_rel = 0.5, i.e.Â it is placed in the center of the system. If the number of replicas in the cut box vector direction are even, then this default fault position will result in the cut and fault planes bisecting the rotated cell along atomically equivalent planes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">surfacesystem</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="n">sf</span><span class="o">.</span><span class="n">shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">surfacesystem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 5.728,  0.000,  0.000]
bvect =  [ 2.864,  4.960,  0.000]
cvect =  [ 0.000,  0.000, 28.059]
origin = [ 0.000,  0.000,  0.000]
natoms = 48
natypes = 1
symbols = (&#39;Al&#39;,)
pbc = [ True  True False]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   5.728 |   4.960 |   1.169
      1 |       1 |   7.159 |   2.480 |   1.169
      2 |       1 |   4.296 |   2.480 |   1.169
      3 |       1 |   8.591 |   4.960 |   1.169
      4 |       1 |   1.432 |   0.827 |   3.507
      5 |       1 |   4.296 |   0.827 |   3.507
      6 |       1 |   2.864 |   3.307 |   3.507
      7 |       1 |   5.728 |   3.307 |   3.507
      8 |       1 |   5.728 |   1.653 |   5.846
      9 |       1 |   4.296 |   4.134 |   5.846
     10 |       1 |   7.159 |   4.134 |   5.846
     11 |       1 |   2.864 |   1.653 |   5.846
     12 |       1 |   5.728 |   4.960 |   8.184
     13 |       1 |   7.159 |   2.480 |   8.184
     14 |       1 |   4.296 |   2.480 |   8.184
     15 |       1 |   8.591 |   4.960 |   8.184
     16 |       1 |   1.432 |   0.827 |  10.522
     17 |       1 |   4.296 |   0.827 |  10.522
     18 |       1 |   2.864 |   3.307 |  10.522
     19 |       1 |   5.728 |   3.307 |  10.522
     20 |       1 |   5.728 |   1.653 |  12.860
     21 |       1 |   4.296 |   4.134 |  12.860
     22 |       1 |   7.159 |   4.134 |  12.860
     23 |       1 |   2.864 |   1.653 |  12.860
     24 |       1 |   5.728 |   4.960 |  15.199
     25 |       1 |   7.159 |   2.480 |  15.199
     26 |       1 |   4.296 |   2.480 |  15.199
     27 |       1 |   8.591 |   4.960 |  15.199
     28 |       1 |   1.432 |   0.827 |  17.537
     29 |       1 |   4.296 |   0.827 |  17.537
     30 |       1 |   2.864 |   3.307 |  17.537
     31 |       1 |   5.728 |   3.307 |  17.537
     32 |       1 |   5.728 |   1.653 |  19.875
     33 |       1 |   4.296 |   4.134 |  19.875
     34 |       1 |   7.159 |   4.134 |  19.875
     35 |       1 |   2.864 |   1.653 |  19.875
     36 |       1 |   5.728 |   4.960 |  22.214
     37 |       1 |   7.159 |   2.480 |  22.214
     38 |       1 |   4.296 |   2.480 |  22.214
     39 |       1 |   8.591 |   4.960 |  22.214
     40 |       1 |   1.432 |   0.827 |  24.552
     41 |       1 |   4.296 |   0.827 |  24.552
     42 |       1 |   2.864 |   3.307 |  24.552
     43 |       1 |   5.728 |   3.307 |  24.552
     44 |       1 |   5.728 |   1.653 |  26.890
     45 |       1 |   4.296 |   4.134 |  26.890
     46 |       1 |   7.159 |   4.134 |  26.890
     47 |       1 |   2.864 |   1.653 |  26.890
</pre></div></div>
</div>
</div>
<div class="section" id="4.1.4.-Check-the-free-surface-system-and-fault-position">
<h4>4.1.4. Check the free surface system and fault position<a class="headerlink" href="#4.1.4.-Check-the-free-surface-system-and-fault-position" title="Permalink to this headline">Â¶</a></h4>
<p>Once the free surface configuration has been created, the quality of the fault position can be checked with the following class attributes:</p>
<ul class="simple">
<li><p><strong>abovefault</strong> is a boolean mask indicating which atoms are above the fault plane. A good fault position should have (roughly) the same number of atoms above and below the plane.</p></li>
<li><p><strong>faultpos_rel</strong> is the relative position of the fault plane.</p></li>
<li><p><strong>faultpos_cart</strong> is the absolute Cartesian position of the fault plane.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
48 total atoms
24 atoms above the fault

Relative fault plane position: 0.5
Absolute fault plane position: 14.029611541307906
</pre></div></div>
</div>
<p>A different fault position than the default faultpos_rel=0.5 can be set either 1. when surface() is called, 2. by setting to either the faultpos_rel or faultpos_cart after calling surface(), or 3. when calling one of the fault configuration generation methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span><span class="o">.</span><span class="n">faultpos_rel</span> <span class="o">=</span> <span class="mf">0.57</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
48 total atoms
20 atoms above the fault

Relative fault plane position: 0.57
Absolute fault plane position: 15.99375715709101
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span><span class="o">.</span><span class="n">faultpos_cart</span> <span class="o">=</span> <span class="mf">14.029611541307906</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
48 total atoms
24 atoms above the fault

Relative fault plane position: 0.5
Absolute fault plane position: 14.029611541307906
</pre></div></div>
</div>
</div>
<div class="section" id="4.1.5.-Generate-stacking-fault-configuration(s)">
<h4>4.1.5. Generate stacking fault configuration(s)<a class="headerlink" href="#4.1.5.-Generate-stacking-fault-configuration(s)" title="Permalink to this headline">Â¶</a></h4>
<p>A single stacking fault configuration for a specific shift can be generated using the fault() method. A full 1D or 2D array of stacking fault configurations can be generated using the iterfaultmap() method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">faultsystem</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">fault</span><span class="p">(</span><span class="n">a1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atoms in faultsystem are displaced by:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">surfacesystem</span><span class="p">,</span> <span class="n">faultsystem</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
atoms in faultsystem are displaced by:
[[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 8.88178420e-16  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 8.88178420e-16  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]
 [ 1.43189123e+00 -1.11022302e-16  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]
 [ 1.43189123e+00 -1.11022302e-16  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00  0.00000000e+00  0.00000000e+00]
 [ 1.43189123e+00 -2.22044605e-16  0.00000000e+00]]
</pre></div></div>
</div>
<p>Generate configurations along the slip line with StackingFault.iterfaultmap(). Note that the displacements may wrap due to periodic boundaries.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">faultsystem</span> <span class="ow">in</span> <span class="n">sf</span><span class="o">.</span><span class="n">iterfaultmap</span><span class="p">(</span><span class="n">num_a1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_a2</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">surfacesystem</span><span class="p">,</span> <span class="n">faultsystem</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;a1 = </span><span class="si">{a1:.1f}</span><span class="s1">, a2 = </span><span class="si">{a2:.1f}</span><span class="s1">, d = [</span><span class="si">{d[0]: 5.3f}</span><span class="s1"> </span><span class="si">{d[1]: 5.3f}</span><span class="s1"> </span><span class="si">{d[2]: 5.3f}</span><span class="s1">]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
a1 = 0.0, a2 = 0.0, d = [ 0.000  0.000  0.000]
a1 = 0.2, a2 = 0.0, d = [ 0.573  0.000  0.000]
a1 = 0.4, a2 = 0.0, d = [ 1.146 -0.000  0.000]
a1 = 0.6, a2 = 0.0, d = [ 1.718 -0.000  0.000]
a1 = 0.8, a2 = 0.0, d = [ 2.291 -0.000  0.000]
a1 = 0.0, a2 = 0.2, d = [ 0.286  0.496  0.000]
a1 = 0.2, a2 = 0.2, d = [ 0.859  0.496  0.000]
a1 = 0.4, a2 = 0.2, d = [ 1.432  0.496  0.000]
a1 = 0.6, a2 = 0.2, d = [ 2.005  0.496  0.000]
a1 = 0.8, a2 = 0.2, d = [ 2.577  0.496  0.000]
a1 = 0.0, a2 = 0.4, d = [ 0.573  0.992  0.000]
a1 = 0.2, a2 = 0.4, d = [ 1.146  0.992  0.000]
a1 = 0.4, a2 = 0.4, d = [ 1.718  0.992  0.000]
a1 = 0.6, a2 = 0.4, d = [ 2.291  0.992  0.000]
a1 = 0.8, a2 = 0.4, d = [-2.864  0.992  0.000]
a1 = 0.0, a2 = 0.6, d = [ 0.859  1.488  0.000]
a1 = 0.2, a2 = 0.6, d = [ 1.432  1.488  0.000]
a1 = 0.4, a2 = 0.6, d = [ 2.005  1.488  0.000]
a1 = 0.6, a2 = 0.6, d = [ 2.577  1.488  0.000]
a1 = 0.8, a2 = 0.6, d = [-2.577  1.488  0.000]
a1 = 0.0, a2 = 0.8, d = [ 1.146  1.984  0.000]
a1 = 0.2, a2 = 0.8, d = [ 1.718  1.984  0.000]
a1 = 0.4, a2 = 0.8, d = [ 2.291  1.984  0.000]
a1 = 0.6, a2 = 0.8, d = [ 0.000 -2.976  0.000]
a1 = 0.8, a2 = 0.8, d = [-2.291  1.984  0.000]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.2.-fcc-{111}-using-primitive-unit-cell">
<h3>4.2. fcc {111} using primitive unit cell<a class="headerlink" href="#4.2.-fcc-{111}-using-primitive-unit-cell" title="Permalink to this headline">Â¶</a></h3>
<p>Just like with the FreeSurface class, a primitive unit cell can be given with a conventional (hkl) slip plane by specifying what the conventional cellâs setting/centering is.</p>
<p>The advantages of doing this for StackingFaults are</p>
<ul class="simple">
<li><p>the resulting systems will be smaller in the in-plane directions making DFT calculations easier, and</p></li>
<li><p>the default shifting vectors will be the smallest in-plane lattice vectors.</p></li>
</ul>
<div class="section" id="4.2.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault">
<h4>4.2.1. Define an fcc primitive cell and initialize a StackingFault<a class="headerlink" href="#4.2.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">4.05</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">trigonal</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">60</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plane_hkl</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]</span>
<span class="n">conventional_setting</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">StackingFault</span><span class="p">(</span><span class="n">plane_hkl</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">conventional_setting</span><span class="o">=</span><span class="n">conventional_setting</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.2.2.-Check-the-identified-rotated-system-and-shift-vectors">
<h4>4.2.2. Check the identified rotated system and shift vectors<a class="headerlink" href="#4.2.2.-Check-the-identified-rotated-system-and-shift-vectors" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">uvws</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.  -0.5  0.5]
 [ 0.5 -0.5  0. ]
 [-1.  -1.  -1. ]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">rcell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 2.864,  0.000,  0.000]
bvect =  [ 1.432,  2.480,  0.000]
cvect =  [ 0.000,  0.000,  7.015]
origin = [ 0.000,  0.000,  0.000]
natoms = 3
natypes = 1
symbols = (&#39;Al&#39;,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   1.432 |   0.827 |   4.677
      1 |       1 |   2.864 |   1.653 |   2.338
      2 |       1 |   1.432 |   2.480 |   0.000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The crystal shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Cartesian shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_cart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The crystal shift vectors:
[ 0.  -0.5  0.5]
[ 0.5 -0.5  0. ]
The Cartesian shift vectors:
[ 2.86378246e+00  2.86439546e-16 -2.38358656e-16]
[ 1.43189123e+00  2.48010836e+00 -2.46533587e-16]
</pre></div></div>
</div>
<p>Now, we have an rcell with 1/4 the atoms and the algorithm automatically identified the same âbestâ shifts that we had to manually specify for the conventional cell!</p>
</div>
<div class="section" id="4.2.3.-Build-the-free-surface-configuration">
<h4>4.2.3. Build the free surface configuration<a class="headerlink" href="#4.2.3.-Build-the-free-surface-configuration" title="Permalink to this headline">Â¶</a></h4>
<p>The <strong>vacuumwidth</strong> parameter of surface() inserts a volume of vacuum at the free surface of this width. DFT calculations are more efficient for free surfaces introduced with a volume of vacuum rather than making one dimension non-periodic.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">surfacesystem</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="n">sf</span><span class="o">.</span><span class="n">shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">minwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vacuumwidth</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">surfacesystem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 2.864,  0.000,  0.000]
bvect =  [ 1.432,  2.480,  0.000]
cvect =  [ 0.000,  0.000, 48.059]
origin = [ 0.000,  0.000, -10.000]
natoms = 12
natypes = 1
symbols = (&#39;Al&#39;,)
pbc = [ True  True False]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   1.432 |   0.827 |   5.846
      1 |       1 |   2.864 |   1.653 |   3.507
      2 |       1 |   1.432 |   2.480 |   1.169
      3 |       1 |   1.432 |   0.827 |  12.860
      4 |       1 |   2.864 |   1.653 |  10.522
      5 |       1 |   1.432 |   2.480 |   8.184
      6 |       1 |   1.432 |   0.827 |  19.875
      7 |       1 |   2.864 |   1.653 |  17.537
      8 |       1 |   1.432 |   2.480 |  15.199
      9 |       1 |   1.432 |   0.827 |  26.890
     10 |       1 |   2.864 |   1.653 |  24.552
     11 |       1 |   1.432 |   2.480 |  22.214
</pre></div></div>
</div>
</div>
<div class="section" id="4.2.4.-Check-the-free-surface-system-and-fault-position">
<h4>4.2.4. Check the free surface system and fault position<a class="headerlink" href="#4.2.4.-Check-the-free-surface-system-and-fault-position" title="Permalink to this headline">Â¶</a></h4>
<p>The vacuum region changes the box dimensions but not the Cartesian atomic positions. As such, the Cartesian fault positions are the same with and without the vacuum region, but the relative fault positions are different for all but one value. Half of the vacuum region is added to the bottom of the system (by shifting origin) and the other half is added to the top. This means that a relative shift of 0.5 results in the same Cartesian location.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
12 total atoms
6 atoms above the fault

Relative fault plane position: 0.5
Absolute fault plane position: 14.029611541307904
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span><span class="o">.</span><span class="n">faultpos_rel</span> <span class="o">=</span> <span class="mf">0.57</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
12 total atoms
5 atoms above the fault

Relative fault plane position: 0.57
Absolute fault plane position: 17.39375715709101
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span><span class="o">.</span><span class="n">faultpos_cart</span> <span class="o">=</span> <span class="mf">14.029611541307906</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{sf.system.natoms}</span><span class="s1"> total atoms&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{sf.abovefault.sum()} atoms above the fault&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Relative fault plane position: </span><span class="si">{sf.faultpos_rel}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Absolute fault plane position: </span><span class="si">{sf.faultpos_cart}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
12 total atoms
6 atoms above the fault

Relative fault plane position: 0.5000000000000001
Absolute fault plane position: 14.029611541307906
</pre></div></div>
</div>
</div>
<div class="section" id="4.2.5.-Generate-stacking-fault-configuration(s)">
<h4>4.2.5. Generate stacking fault configuration(s)<a class="headerlink" href="#4.2.5.-Generate-stacking-fault-configuration(s)" title="Permalink to this headline">Â¶</a></h4>
<p>Further support for DFT is that the fault() and iterfaultmap() methods also have a <strong>minimum_r</strong> parameter that can be used to ensure all atoms across the fault plane remain at least a set distance apart. This can help with relaxations when certain faults may otherwise position atoms very close together.</p>
<p>Here, minimum_r is set to be 0.85 of the unit cellâs smallest interatomic vector r0. This results in some shifts in the z direction for certain fault configurations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">faultsystem</span> <span class="ow">in</span> <span class="n">sf</span><span class="o">.</span><span class="n">iterfaultmap</span><span class="p">(</span><span class="n">num_a1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_a2</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">minimum_r</span><span class="o">=</span><span class="mf">0.85</span><span class="o">*</span><span class="n">ucell</span><span class="o">.</span><span class="n">r0</span><span class="p">()):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">surfacesystem</span><span class="p">,</span> <span class="n">faultsystem</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;a1 = </span><span class="si">{a1:.1f}</span><span class="s1">, a2 = </span><span class="si">{a2:.1f}</span><span class="s1">, d = [</span><span class="si">{d[0]: 5.3f}</span><span class="s1"> </span><span class="si">{d[1]: 5.3f}</span><span class="s1"> </span><span class="si">{d[2]: 5.3f}</span><span class="s1">]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
a1 = 0.0, a2 = 0.0, d = [ 0.000  0.000  0.000]
a1 = 0.2, a2 = 0.0, d = [ 0.573  0.000  0.000]
a1 = 0.4, a2 = 0.0, d = [ 1.146  0.000  0.000]
a1 = 0.6, a2 = 0.0, d = [-1.146  0.000  0.000]
a1 = 0.8, a2 = 0.0, d = [-0.573  0.000  0.000]
a1 = 0.0, a2 = 0.2, d = [ 0.286  0.496  0.000]
a1 = 0.2, a2 = 0.2, d = [ 0.859  0.496  0.004]
a1 = 0.4, a2 = 0.2, d = [-1.432  0.496  0.073]
a1 = 0.6, a2 = 0.2, d = [-0.859  0.496  0.004]
a1 = 0.8, a2 = 0.2, d = [-0.286  0.496  0.000]
a1 = 0.0, a2 = 0.4, d = [ 0.573  0.992  0.000]
a1 = 0.2, a2 = 0.4, d = [ 1.146  0.992  0.073]
a1 = 0.4, a2 = 0.4, d = [-1.146  0.992  0.073]
a1 = 0.6, a2 = 0.4, d = [-0.573  0.992  0.000]
a1 = 0.8, a2 = 0.4, d = [-0.000  0.992  0.000]
a1 = 0.0, a2 = 0.6, d = [-0.573 -0.992  0.000]
a1 = 0.2, a2 = 0.6, d = [ 0.000 -0.992  0.004]
a1 = 0.4, a2 = 0.6, d = [ 0.573 -0.992  0.000]
a1 = 0.6, a2 = 0.6, d = [ 1.146 -0.992  0.000]
a1 = 0.8, a2 = 0.6, d = [-1.146 -0.992  0.000]
a1 = 0.0, a2 = 0.8, d = [-0.286 -0.496  0.000]
a1 = 0.2, a2 = 0.8, d = [ 0.286 -0.496  0.000]
a1 = 0.4, a2 = 0.8, d = [ 0.859 -0.496  0.000]
a1 = 0.6, a2 = 0.8, d = [ 1.432 -0.496  0.000]
a1 = 0.8, a2 = 0.8, d = [-0.859 -0.496  0.000]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.3.-hcp-{0001}-slip-plane">
<h3>4.3. hcp {0001} slip plane<a class="headerlink" href="#4.3.-hcp-{0001}-slip-plane" title="Permalink to this headline">Â¶</a></h3>
<p>The system rotation vectors and the shifting vectors can be given in Miller-Bravais indices if the reference unit cell is hexagonal.</p>
<div class="section" id="4.3.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault">
<h4>4.3.1. Define an fcc primitive cell and initialize a StackingFault<a class="headerlink" href="#4.3.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault" title="Permalink to this headline">Â¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">3.18</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">5.17</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">hexagonal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plane_hkl</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]</span>

<span class="n">sf</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">StackingFault</span><span class="p">(</span><span class="n">plane_hkl</span><span class="p">,</span> <span class="n">ucell</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.3.2.-Check-the-identified-rotated-system-and-shift-vectors">
<h4>4.3.2. Check the identified rotated system and shift vectors<a class="headerlink" href="#4.3.2.-Check-the-identified-rotated-system-and-shift-vectors" title="Permalink to this headline">Â¶</a></h4>
<p>If plane_hkl was given in the 4-index representation, then uvws, a1vect_uvw and a2vect_uvw will be saved in the 4-index representation as well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">uvws</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.66666667 -0.33333333 -0.33333333  0.        ]
 [ 0.33333333  0.33333333 -0.66666667  0.        ]
 [ 0.          0.         -0.          1.        ]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">rcell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 3.180,  0.000,  0.000]
bvect =  [ 1.590,  2.754,  0.000]
cvect =  [ 0.000,  0.000,  5.170]
origin = [ 0.000,  0.000,  0.000]
natoms = 2
natypes = 1
symbols = (None,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   0.000 |   0.000 |   0.000
      1 |       1 |   3.180 |   1.836 |   2.585
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The crystal shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_uvw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Cartesian shift vectors:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a1vect_cart</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">a2vect_cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The crystal shift vectors:
[ 0.66666667 -0.33333333 -0.33333333  0.        ]
[ 0.33333333  0.33333333 -0.66666667  0.        ]
The Cartesian shift vectors:
[ 3.18000000e+00 -2.73153518e-16  0.00000000e+00]
[1.59       2.75396078 0.        ]
</pre></div></div>
</div>
<p>The remaining steps are similar to those mentioned for the other systems above.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to atomman: Stacking fault generator</a><ul>
<li><a class="reference internal" href="#1.-Introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#2.-Theory">2. Theory</a></li>
<li><a class="reference internal" href="#3.-Class-basics">3. Class basics</a><ul>
<li><a class="reference internal" href="#3.1.-StackingFault-initialization">3.1. StackingFault initialization</a></li>
<li><a class="reference internal" href="#3.2.-StackingFault.surface()">3.2. StackingFault.surface()</a></li>
<li><a class="reference internal" href="#3.3.-StackingFault.fault()">3.3. StackingFault.fault()</a></li>
<li><a class="reference internal" href="#3.4.-StackingFault.iterfaultmap()">3.4. StackingFault.iterfaultmap()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Examples">4. Examples</a><ul>
<li><a class="reference internal" href="#4.1.-fcc-\{111\}">4.1. fcc <span class="math notranslate nohighlight">\(\{111\}\)</span></a><ul>
<li><a class="reference internal" href="#4.1.1.-Define-an-fcc-conventional-cell-and-initialize-a-StackingFault">4.1.1. Define an fcc conventional cell and initialize a StackingFault</a></li>
<li><a class="reference internal" href="#4.1.2.-Check-the-identified-rotated-system">4.1.2. Check the identified rotated system</a></li>
<li><a class="reference internal" href="#4.1.3.-Build-the-free-surface-configuration">4.1.3. Build the free surface configuration</a></li>
<li><a class="reference internal" href="#4.1.4.-Check-the-free-surface-system-and-fault-position">4.1.4. Check the free surface system and fault position</a></li>
<li><a class="reference internal" href="#4.1.5.-Generate-stacking-fault-configuration(s)">4.1.5. Generate stacking fault configuration(s)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.2.-fcc-{111}-using-primitive-unit-cell">4.2. fcc {111} using primitive unit cell</a><ul>
<li><a class="reference internal" href="#4.2.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault">4.2.1. Define an fcc primitive cell and initialize a StackingFault</a></li>
<li><a class="reference internal" href="#4.2.2.-Check-the-identified-rotated-system-and-shift-vectors">4.2.2. Check the identified rotated system and shift vectors</a></li>
<li><a class="reference internal" href="#4.2.3.-Build-the-free-surface-configuration">4.2.3. Build the free surface configuration</a></li>
<li><a class="reference internal" href="#4.2.4.-Check-the-free-surface-system-and-fault-position">4.2.4. Check the free surface system and fault position</a></li>
<li><a class="reference internal" href="#4.2.5.-Generate-stacking-fault-configuration(s)">4.2.5. Generate stacking fault configuration(s)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.3.-hcp-{0001}-slip-plane">4.3. hcp {0001} slip plane</a><ul>
<li><a class="reference internal" href="#4.3.1.-Define-an-fcc-primitive-cell-and-initialize-a-StackingFault">4.3.1. Define an fcc primitive cell and initialize a StackingFault</a></li>
<li><a class="reference internal" href="#4.3.2.-Check-the-identified-rotated-system-and-shift-vectors">4.3.2. Check the identified rotated system and shift vectors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="4.2._Free_surface_generator.html"
                        title="previous chapter">Introduction to atomman: Free surface generator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="4.4._Dislocation_solution_and_generator.html"
                        title="next chapter">Introduction to atomman: Dislocation solution and generator</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="4.4._Dislocation_solution_and_generator.html" title="Introduction to atomman: Dislocation solution and generator"
             >next</a> |</li>
        <li class="right" >
          <a href="4.2._Free_surface_generator.html" title="Introduction to atomman: Free surface generator"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.4.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>