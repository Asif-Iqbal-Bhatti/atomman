
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to atomman: Semidiscrete variational Peierls-Nabarro model &#8212; atomman 1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to atomman: Periodic array of dislocations" href="04.8._Periodic_array_of_dislocations.html" />
    <link rel="prev" title="Introduction to atomman: Gamma surface plotting" href="04.6._Gamma_surface_plotting.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="04.8._Periodic_array_of_dislocations.html" title="Introduction to atomman: Periodic array of dislocations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="04.6._Gamma_surface_plotting.html" title="Introduction to atomman: Gamma surface plotting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Introduction-to-atomman:-Semidiscrete-variational-Peierls-Nabarro-model">
<h1>Introduction to atomman: Semidiscrete variational Peierls-Nabarro model<a class="headerlink" href="#Introduction-to-atomman:-Semidiscrete-variational-Peierls-Nabarro-model" title="Permalink to this headline">¶</a></h1>
<p><strong>Lucas M. Hale</strong>, <a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>, <em>Materials Science and Engineering Division, NIST</em>.</p>
<p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">Disclaimers</a></p>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">¶</a></h2>
<p>This Notebook outlines how to calculate semidiscrete variational Peierls-Nabarro models of dislocation disregistries. This calculation method gives a prediction for a dislocation structure using only the material’s elastic constants and the generalized stacking fault energy map associated with the dislocation’s slip plane.</p>
<p><strong>NOTE:</strong> the calculation process is complex and may be refined over time resulting in changes to the involved functions and classes. For this reason, be aware of the atomman version used.</p>
<p><strong>Library Imports</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Standard Python libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>

<span class="c1"># https://matplotlib.org/</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Show atomman version</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomman version =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Show date of Notebook execution</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
atomman version = 1.3.0
Notebook executed on 2019-11-05
</pre></div></div>
</div>
<div class="section" id="1.1.-Theory">
<h3>1.1. Theory<a class="headerlink" href="#1.1.-Theory" title="Permalink to this headline">¶</a></h3>
<p>The equations and calculations used are based on the original semidiscrete variational Peierls-Nabarro by Bulatov, et. al [<a class="reference external" href="https://doi.org/10.1103/PhysRevLett.78.4221">1</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevB.62.3099">2</a>, <a class="reference external" href="https://doi.org/10.1080/09500830050143778">3</a>], as well as additional and alternate terms [<a class="reference external" href="https://doi.org/10.1016/S0022-5096(98)00057-X">4</a>, <a class="reference external" href="https://doi.org/10.1088/1751-8113/42/2/025208">5</a>, <a class="reference external" href="https://doi.org/10.1016/j.scriptamat.2016.04.013">6</a>,
<a class="reference external" href="https://doi.org/10.1016/j.commatsci.2017.01.038">7</a>]. The discussion here is very brief and it is left to the reader to see the referenced papers for more details.</p>
<div class="section" id="1.1.1.-Disregistry-and-dislocation-density">
<h4>1.1.1. Disregistry and dislocation density<a class="headerlink" href="#1.1.1.-Disregistry-and-dislocation-density" title="Permalink to this headline">¶</a></h4>
<p>The disregistry of a dislocation, <span class="math notranslate nohighlight">\(\delta_i\)</span>, is defined as the difference in the displacement just above and below the slip plane taken as a function of the coordinate <span class="math notranslate nohighlight">\(\xi\)</span> that is along the slip plane and perpendicular to the dislocation line.</p>
<div class="math notranslate nohighlight">
\[\delta_i(\xi) = u_i^+(\xi) - u_i^-(\xi)\]</div>
<p>A dislocation density, <span class="math notranslate nohighlight">\(\rho_i\)</span>, is also defined that can be thought of as the infinitesimal Burgers vector of the dislocation at any specific <span class="math notranslate nohighlight">\(\xi\)</span> point, and is related to <span class="math notranslate nohighlight">\(\delta_i\)</span> as</p>
<div class="math notranslate nohighlight">
\[\rho_i(\xi) = \frac{d \delta_i(\xi)}{d \xi}\]</div>
<p>For a slip plane containing a single dislocation in an otherwise infinite medium, <span class="math notranslate nohighlight">\(\delta_i\)</span> and <span class="math notranslate nohighlight">\(\rho_i\)</span> can be related to the dislocation’s Burgers vector, <span class="math notranslate nohighlight">\(b_i\)</span></p>
<div class="math notranslate nohighlight">
\[\delta_i(\infty) - \delta_i(-\infty) = b_i\]</div>
<div class="math notranslate nohighlight">
\[\int_{-\infty}^{+\infty}{\rho_i(\xi) d\xi} = b_i\]</div>
</div>
<div class="section" id="1.1.2.-Semidiscrete-variational-Peierls-Nabarro-model">
<h4>1.1.2. Semidiscrete variational Peierls-Nabarro model<a class="headerlink" href="#1.1.2.-Semidiscrete-variational-Peierls-Nabarro-model" title="Permalink to this headline">¶</a></h4>
<p>The semidiscrete variational Peierls-Nabarro (SDVPN) model expresses the energy of a dislocation as a summation of different energy terms, each of which is a function of <span class="math notranslate nohighlight">\(\delta_i\)</span>. Here, the general dislocation energy equation is</p>
<div class="math notranslate nohighlight">
\[U_{dislocation} = U_{elastic} + U_{misfit} + U_{stress} + U_{surface} + U_{nonlocal}\]</div>
<p>Each of the energy terms is expressed with a discrete formulation that assumes the disregistry is a step function evaluated at certain points and constant in between. The disregistry is evaluated at regular intervals, with <span class="math notranslate nohighlight">\(\Delta \xi\)</span> typically corresponding to a spacing of atomic columns along the <span class="math notranslate nohighlight">\(\xi\)</span> direction giving the calculation a discreteness corresponding to an actual atomic discreteness. The SDVPN model then solves for the disregistry at the evaluated <span class="math notranslate nohighlight">\(\xi\)</span> points
that minimizes the dislocation’s energy.</p>
</div>
<div class="section" id="1.1.3-Elastic-energy">
<h4>1.1.3 Elastic energy<a class="headerlink" href="#1.1.3-Elastic-energy" title="Permalink to this headline">¶</a></h4>
<p>The elastic energy is due to the elastic energy of the dislocation. It contains two components: a configuration-dependent part associated with the interaction of the dislocation at one position interacting with the dislocation at another point, and a configuration-independent part associated with the dislocation’s long-range strain field. The elastic energy is expressed as</p>
<div class="math notranslate nohighlight">
\[U_{elastic} = \frac{1}{4\pi} \sum_i{\left[ \sum_j{\left( \chi(i, j, \Delta \xi) K_{lm} \rho_l[i] \rho_m[j] \right)} \right]} + \frac{1}{4\pi} K_{lm} b_l b_m \ln{(L)},\]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> are integer indexes of the <span class="math notranslate nohighlight">\(\xi\)</span> evaluation points, i.e. <span class="math notranslate nohighlight">\(\xi[i+1] = \xi[i] + \Delta \xi\)</span>, <span class="math notranslate nohighlight">\(K_{lm}\)</span> is the dislocation’s energy coefficient tensor, <span class="math notranslate nohighlight">\(L\)</span> is a cutoff radius for the long-range configuration-independent elastic energy, and <span class="math notranslate nohighlight">\(\chi\)</span> is a multiplicative factor related to the distance between points <span class="math notranslate nohighlight">\(\xi[i]\)</span> and <span class="math notranslate nohighlight">\(\xi[j]\)</span> given by</p>
<div class="math notranslate nohighlight">
\[\chi(i,j,\Delta \xi) = \frac{3}{2} \Delta \xi^2 + \psi(i-1,j-1,\Delta \xi) + \psi(i,j,\Delta \xi) - \psi(i,j-1,\Delta \xi) - \psi(j,i-1,\Delta \xi),\]</div>
<div class="math notranslate nohighlight">
\[\psi(i,j,\Delta \xi) = \frac{1}{2} (i-j)^2 \Delta \xi^2 \ln{(|i-j|\Delta \xi)}.\]</div>
<p>The dislocation density, <span class="math notranslate nohighlight">\(\rho_l\)</span>, is obtained from the discrete <span class="math notranslate nohighlight">\(\delta_l\)</span> as</p>
<div class="math notranslate nohighlight">
\[\rho_l[i] = \frac{\delta_l[i] - \delta_l[i-1]}{\Delta \xi}\]</div>
<p><strong>NOTE:</strong> slightly different forms for <span class="math notranslate nohighlight">\(U_{elastic}\)</span> are found in the references due to how the different authors define the energy coefficient tensor, <span class="math notranslate nohighlight">\(K_{lm}\)</span>. Here, <span class="math notranslate nohighlight">\(K_{lm}\)</span> is defined such that in the isotropic case <span class="math notranslate nohighlight">\(K_{33} = K_{screw} = \mu\)</span>, and <span class="math notranslate nohighlight">\(K_{11} = K_{edge} = \frac{\mu}{1-\nu}\)</span> where <span class="math notranslate nohighlight">\(\mu\)</span> is the shear modulus and <span class="math notranslate nohighlight">\(\nu\)</span> is the Poisson’s ratio.</p>
</div>
<div class="section" id="1.1.4.-Misfit-energy">
<h4>1.1.4. Misfit energy<a class="headerlink" href="#1.1.4.-Misfit-energy" title="Permalink to this headline">¶</a></h4>
<p>The misfit energy arises from the disregistry within the dislocation spreading coinciding with crystallographically unfavorable configurations. This energy is calculated by mapping the dislocation’s disregistry onto a generalized stacking fault energy map, i.e <span class="math notranslate nohighlight">\(\gamma\)</span> surface</p>
<div class="math notranslate nohighlight">
\[U_{misfit} = \sum_i \gamma(\delta_l[i]) \Delta \xi.\]</div>
</div>
<div class="section" id="1.1.5.-Stress-energy">
<h4>1.1.5. Stress energy<a class="headerlink" href="#1.1.5.-Stress-energy" title="Permalink to this headline">¶</a></h4>
<p>The stress energy computes the energy due to an externally applied stress, <span class="math notranslate nohighlight">\(\tau_{ij}\)</span>, interacting with the dislocation line. Two forms have been used in SDVPN models: the original full stress form</p>
<div class="math notranslate nohighlight">
\[U_{stress} = -\frac{1}{2} \sum_i{ \left[ \left(\xi[i]^2 - \xi[i-1]^2 \right) \rho_l[i] \tau_{2l} \right]},\]</div>
<p>and a truncated form introduced by ??</p>
<div class="math notranslate nohighlight">
\[U_{stress} = -\frac{1}{2} \sum_i{ \left[ \tau_{2l} \left(\delta_l[i] + \delta_l[i+1] \right) \Delta \xi  \right]}.\]</div>
<p>The two should be equivalent except for a configuration-independent constant.</p>
</div>
<div class="section" id="1.1.6.-Surface-energy">
<h4>1.1.6. Surface energy<a class="headerlink" href="#1.1.6.-Surface-energy" title="Permalink to this headline">¶</a></h4>
<p>The surface energy is a correction term introduced by [<a class="reference external" href="https://doi.org/10.1088/1751-8113/42/2/025208">5</a>] to account for the surface effect along the slip plane. The discrete gradient formulation by [<a class="reference external" href="https://doi.org/10.1016/j.scriptamat.2016.04.013">6</a>] is used by atomman</p>
<div class="math notranslate nohighlight">
\[U_{surface} = \sum_{j=1}^3 {\frac{\beta_{lj}}{4} \sum_i {\rho_l[i]^2 \Delta \xi }}\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta_{lj}\)</span> is a coefficient tensor. Terms in the coefficient tensor can be</p>
</div>
<div class="section" id="1.1.7.-Nonlocal-energy">
<h4>1.1.7. Nonlocal energy<a class="headerlink" href="#1.1.7.-Nonlocal-energy" title="Permalink to this headline">¶</a></h4>
<p>The nonlocal energy is an alternate correction term introduced by [<a class="reference external" href="https://doi.org/10.1016/S0022-5096(98)00057-X">4</a>] to account for the nonlocal interactions directly. It is of the form</p>
<div class="math notranslate nohighlight">
\[U_{nonlocal} = \sum_m{ \alpha_m \sum_i{ \delta_l[i] \left(\delta_l[i] - \frac{\delta_l[i+m] + \delta_l[i-m]}{2} \right) \Delta \xi }}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_m\)</span> are correction coefficients corresponding to increasing separations between the evaluated <span class="math notranslate nohighlight">\(\xi\)</span> points. Typically, only the first coefficient <span class="math notranslate nohighlight">\(\alpha_1\)</span> is used and it is fitted by minimizing the discrepancy between the SDVPN disregistry and a full atomistic disregistry.</p>
</div>
</div>
<div class="section" id="1.2.-Methodology-overview">
<h3>1.2. Methodology overview<a class="headerlink" href="#1.2.-Methodology-overview" title="Permalink to this headline">¶</a></h3>
<p>Due to the complex nature of the calculation, this section provides a general overview of the steps involved in setting up and running the calculation shown in the remainder of the Notebook.</p>
<ol class="arabic simple">
<li><span class="math notranslate nohighlight">\(U_{elastic}\)</span> requires the energy coefficient tensor, <span class="math notranslate nohighlight">\(K_{ij}\)</span>, which is related to a material’s elastic constants and the orientation of the slip plane and elastic constants.<ol class="loweralpha">
<li>Isotropic <span class="math notranslate nohighlight">\(K_{ij}\)</span> can be calculated using a material’s shear modulus and Poisson’s ratio: <span class="math notranslate nohighlight">\(K_{11} = K_{22} = \frac{\mu}{1-\nu}\)</span>, <span class="math notranslate nohighlight">\(K_{33} = \mu\)</span>, <span class="math notranslate nohighlight">\(K_{ij} = 0\)</span> for <span class="math notranslate nohighlight">\(i \ne j\)</span>.</li>
<li>Anisotropic <span class="math notranslate nohighlight">\(K_{ij}\)</span> can be calculated using the Stroh method.</li>
</ol>
</li>
<li>A function for <span class="math notranslate nohighlight">\(\gamma(\delta_i)\)</span> needs to be created. <strong>NOTE:</strong> Only 2D GSFs currently implemented.<ol class="loweralpha">
<li>Use an analytical function.</li>
<li>2D GSF: Measure relaxed generalized stacking fault energies in two dimensions. Interpolate <span class="math notranslate nohighlight">\(\gamma(\delta_i)\)</span> dependent on <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_3\)</span>.</li>
<li>Pseudo 3D GSF: Measure relaxed generalized stacking fault energies in two dimensions and the associated relaxation perpendicular to the fault plane. Interpolate <span class="math notranslate nohighlight">\(\gamma(\delta_i)\)</span> and <span class="math notranslate nohighlight">\(\delta_2\)</span> dependent on <span class="math notranslate nohighlight">\(\delta_1\)</span> and <span class="math notranslate nohighlight">\(\delta_3\)</span>.</li>
<li>3D GSF: Measure unrelaxed generalized stacking fault energies in thre dimensions. Interpolate <span class="math notranslate nohighlight">\(\gamma(\delta_i)\)</span> dependent on <span class="math notranslate nohighlight">\(\delta_1\)</span>, <span class="math notranslate nohighlight">\(\delta_2\)</span> and <span class="math notranslate nohighlight">\(\delta_3\)</span>.</li>
</ol>
</li>
<li>Initial disregistry values need to be given for all of the <span class="math notranslate nohighlight">\(\xi\)</span> coordinates.<ol class="loweralpha">
<li>Use a step function such that <span class="math notranslate nohighlight">\(\delta_i(\xi &lt; 0) = 0\)</span> and <span class="math notranslate nohighlight">\(\delta_i(\xi &gt; 0) = b_i\)</span></li>
<li>Use an arctan function that smoothly varies from 0 to <span class="math notranslate nohighlight">\(b_i\)</span>.</li>
</ol>
</li>
<li>Solve the SDVPN model with <span class="math notranslate nohighlight">\(\tau_{ij}\)</span>, <span class="math notranslate nohighlight">\(\beta_{ij}\)</span>, and <span class="math notranslate nohighlight">\(\alpha_m\)</span> values all zero.</li>
<li>(Optional) Starting with the SDVPN solution from #4, add either <span class="math notranslate nohighlight">\(\beta_{ij}\)</span> or <span class="math notranslate nohighlight">\(\alpha_m\)</span> correction constants and solve.</li>
<li>(Optional) To obtain a prediction for the dislocation’s Peierls barrier, incrementally increase <span class="math notranslate nohighlight">\(\tau_{ij}\)</span> and resolve the SDVPN model until the dislocation is observed to move.</li>
</ol>
</div>
</div>
<div class="section" id="2.-Dependent-parameters">
<h2>2. Dependent parameters<a class="headerlink" href="#2.-Dependent-parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="2.1.-Define-material-constants">
<h3>2.1. Define material constants<a class="headerlink" href="#2.1.-Define-material-constants" title="Permalink to this headline">¶</a></h3>
<p>Properties for fcc Al using the 2008–Mendelev-M-I–Al potential</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">4.0453</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>

<span class="n">C11</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">105.09</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">C12</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span> <span class="mf">59.46</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">C44</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span> <span class="mf">30.66</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">ElasticConstants</span><span class="p">(</span><span class="n">C11</span><span class="o">=</span><span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="o">=</span><span class="n">C44</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cij in GPa:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">Cij</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cij in GPa:
[[105.09  59.46  59.46   0.     0.     0.  ]
 [ 59.46 105.09  59.46   0.     0.     0.  ]
 [ 59.46  59.46 105.09   0.     0.     0.  ]
 [  0.     0.     0.    30.66   0.     0.  ]
 [  0.     0.     0.     0.    30.66   0.  ]
 [  0.     0.     0.     0.     0.    30.66]]
</pre></div></div>
</div>
</div>
<div class="section" id="2.2.-Get-K_{ij}-values">
<h3>2.2. Get <span class="math notranslate nohighlight">\(K_{ij}\)</span> values<a class="headerlink" href="#2.2.-Get-K_{ij}-values" title="Permalink to this headline">¶</a></h3>
<p>Define axes and Burgers vector for the <span class="math notranslate nohighlight">\(\frac{a}{2} \left&lt; 10\bar{1} \right&gt; \left\{ 111 \right\}\)</span> fcc edge dislocation. The configuration used by the Stroh method and the SDVPN model are defined with</p>
<ul class="simple">
<li>The slip plane normal to be parallel to the y-axis</li>
<li>The dislocation line to coincide with the z-axis</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">burgers</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">z_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Get the anisotropic K_tensor using the Stroh method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stroh</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">Stroh</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">burgers</span><span class="o">=</span><span class="n">burgers</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">z_axis</span><span class="p">]))</span>

<span class="n">K_tensor</span> <span class="o">=</span> <span class="n">stroh</span><span class="o">.</span><span class="n">K_tensor</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;K_tensor in GPa:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">K_tensor</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
K_tensor in GPa:
[[41.18476659  0.          0.        ]
 [ 0.         41.61278102 -1.20279982]
 [ 0.         -1.20279982 26.51226032]]
</pre></div></div>
</div>
</div>
<div class="section" id="2.3.-\gamma-surface">
<h3>2.3. <span class="math notranslate nohighlight">\(\gamma\)</span> surface<a class="headerlink" href="#2.3.-\gamma-surface" title="Permalink to this headline">¶</a></h3>
<p>The atomman.defect.GammaSurface class loads and represents generalized stacking fault data.</p>
<p>See <a class="reference external" href="04.5._Gamma_Surface_Plotting.html">04.5. Gamma Surface Plotting Notebook</a> for more details on this class.</p>
<p>Load pre-calculated <span class="math notranslate nohighlight">\(\gamma\)</span> surface data from a data model</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load pre-calculated stacking fault energy data</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="s1">&#39;2008--Mendelev-M-I--Al--111-GSF.xml&#39;</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">GammaSurface</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">E_gsf_surface_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_17_0.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_17_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="3.-Generate-initial-disregistry">
<h2>3. Generate initial disregistry<a class="headerlink" href="#3.-Generate-initial-disregistry" title="Permalink to this headline">¶</a></h2>
<p>Solving the SDVPN model requires starting with an initial guess of the disregistry.</p>
<p><strong>pn_arctan_disregistry()</strong></p>
<p>The atomman.defect.pn_arctan_disregistry() function computes the classic Peierls-Nabarro arctan disregistry for an array of points x</p>
<div class="math notranslate nohighlight">
\[\delta_i(x) = \frac{b}{\pi} \arctan{ \left( \frac{x}{\xi} \right)} + \frac{b_i}{2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi\)</span> is the dislocation’s halfwidth and <span class="math notranslate nohighlight">\(b_i\)</span> is the Burgers vector.</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>xmax</strong> (<em>float or None, optional</em>) Maximum value of x to use. Minimum value is taken as -xmax. At least 2 of xmax, xstep, and xnum must be not None. Default value is None.</li>
<li><strong>xstep</strong> (<em>float or None, optional</em>) Step size to use between each x value. At least 2 of xmax, xstep, and xnum must be not None. Default value is None.</li>
<li><strong>xnum</strong> (<em>int or None, optional</em>) Number of x values to use. At least 2 of xmax, xstep, and xnum must be not None. Default value is None.</li>
<li><strong>burgers</strong> (<em>numpy.ndarray, optional</em>) The Burgers vector for the dislocation. Default value is [1, 0, 0].</li>
<li><strong>halfwidth</strong> (<em>float, optional</em>) The dislocation halfwidth to use. Default value is 1.</li>
<li><strong>normalize</strong> (<em>bool, optional</em>) If True (default), the disregistry values will be scaled such that the two endpoints differ by exactly one Burgers vector.</li>
<li><strong>shift</strong> (<em>bool, optional</em>) If True (default), the disregistry will range [0, 0, 0] to burgers. If False, the disregistry will range from -burgers to burgers.</li>
</ul>
<p>Returns</p>
<ul class="simple">
<li><strong>x</strong> (<em>numpy.ndarray</em>) The x-coordinates for the disregistry values.</li>
<li><strong>disregistry</strong> (<em>numpy.ndarray</em>) The disregistry vector at each x-coordinate.</li>
</ul>
<p><strong>NOTE:</strong> the parameters normalize and shift should both be True for use with the SDVPN model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Transform Burgers vector to axes</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">axes_check</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">z_axis</span><span class="p">]))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">burgers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transformed Burgers vector =&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Transformed Burgers vector = [2.86045906 0.         0.        ]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generate disregistry</span>
<span class="n">xstep</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># atomic column separation along [10-1] direction</span>
<span class="n">xnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">halfwidth</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">x</span><span class="p">,</span> <span class="n">disreg</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">pn_arctan_disregistry</span><span class="p">(</span><span class="n">xstep</span><span class="o">=</span><span class="n">xstep</span><span class="p">,</span> <span class="n">xnum</span><span class="o">=</span><span class="n">xnum</span><span class="p">,</span> <span class="n">burgers</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">halfwidth</span><span class="o">=</span><span class="n">halfwidth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">disreg</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;edge disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">disreg</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;normal disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">disreg</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;screw disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-coordinate (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;disregistry (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_23_0.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_23_0.png" />
</div>
</div>
</div>
<div class="section" id="4.-Solve-SDVPN-model">
<h2>4. Solve SDVPN model<a class="headerlink" href="#4.-Solve-SDVPN-model" title="Permalink to this headline">¶</a></h2>
<p>A solution for the SDVPN model will be obtained through minimization upon initializing an object of the SDVPN class. There are numerous parameters that can be set.</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>x</strong> (<em>numpy.ndarray</em>) An array of shape (N) giving the x coordinates corresponding to the disregistry solution.</li>
<li><strong>disregistry</strong> (<em>numpy.ndarray</em>) A (N,3) array giving the initial disregistry vector guess at each x coordinate.</li>
<li><strong>gamma</strong> (<em>atomman.defect.GammaSurface</em>) The gamma surface (stacking fault map) to use for computing the misfit energy.</li>
<li><strong>axes</strong> (<em>numpy.ndarray</em>) A (3,3) array defining the crystal directions of the dislocation system. Used to orient the disregistry vector to the gamma surface in computing the misfit energy.</li>
<li><strong>K_tensor</strong> (<em>numpy.ndarray</em>) A (3,3) array giving the anisotropic elastic energy coefficients corresponding to the dislocation system’s orientation. Can be computed with atomman.defect.Stroh.</li>
<li><strong>tau</strong> (<em>numpy.ndarray, optional</em>) A (3,3) array giving the stress tensor to apply to the system using the stress energy term. Only the xy, yy, and yz components are used. Default value is all zeros.</li>
<li><strong>alpha</strong> (<em>list of float, optional</em>) The alpha coefficient(s) used by the nonlocal energy term. Default value is [0.0].</li>
<li><strong>beta</strong> (<em>numpy.ndarray, optional</em>) The (3,3) array of beta coefficient(s) used by the gradient energy term. Default value is all zeros.</li>
<li><strong>cutofflongrange</strong> (<em>float, optional</em>) The cutoff distance to use for computing the long-range energy. Default value is 1000 Angstroms.</li>
<li><strong>burgers</strong> (<em>numpy.ndarray, optional</em>) The (3,) array of the dislocation’s Burgers vector relative to the dislocation system. Used only by the long-range energy. Default value is all zeros (long-range energy will be excluded).</li>
<li><strong>fullstress</strong> (<em>bool, optional</em>) Flag indicating which stress energy algorithm to use. Default value is True.</li>
<li><strong>cdiffelastic</strong> (<em>bool, optional</em>) Flag indicating if the dislocation density for the elastic energy component is computed with central difference (True) or simply neighboring values (False). Default value is False.</li>
<li><strong>cdiffsurface</strong> (<em>bool, optional</em>) Flag indicating if the dislocation density for the surface energy component is computed with central difference (True) or simply neighboring values (False). Default value is True.</li>
<li><strong>cdiffstress</strong> (<em>bool, optional</em>) Flag indicating if the dislocation density for the stress energy component is computed with central difference (True) or simply neighboring values (False). Only matters if fullstress is True. Default value is False.</li>
<li><strong>min_method</strong> (<em>str, optional</em>) The scipy.optimize.minimize method to use. Default value is ‘Powell’.</li>
<li><strong>min_options</strong> (<em>dict, optional</em>) Any options to pass on to scipy.optimize.minimize. Default value is {}.</li>
</ul>
<p><strong>Execution tips:</strong> Tests seem to indicate that the ‘Powell’ minimization option works well for this problem. For best results, use min_options to set xtol and ftol to smaller values and run the solver multiple times in a row (minimizer may get stuck).</p>
<p>Set parameters and solve the first time</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_options</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">min_options</span><span class="p">[</span><span class="s1">&#39;disp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># will display convergence info</span>
<span class="n">min_options</span><span class="p">[</span><span class="s1">&#39;xtol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="c1"># smaller convergence tolerance than default</span>
<span class="n">min_options</span><span class="p">[</span><span class="s1">&#39;ftol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="c1"># smaller convergence tolerance than default</span>
<span class="c1">#min_options[&#39;maxiter&#39;] = 2 # for testing purposes</span>
<span class="n">pnsolution</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">SDVPN</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">disregistry</span><span class="o">=</span><span class="n">disreg</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                             <span class="n">axes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">z_axis</span><span class="p">]),</span> <span class="n">K_tensor</span><span class="o">=</span><span class="n">K_tensor</span><span class="p">,</span>
                             <span class="n">min_options</span><span class="o">=</span><span class="n">min_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 13
         Function evaluations: 37899
</pre></div></div>
</div>
<p>Values for the different energy terms can be obtained and the disregistry plotted.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dislocation energy terms in eV/angstrom:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Misfit energy =    &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">misfit_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Elastic energy =   &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">elastic_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Long-range energy =&#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">longrange_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Stress energy =    &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">stress_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Surface energy =   &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">surface_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nonlocal energy =  &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">nonlocal_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total energy =     &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">total_energy</span><span class="p">())</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;edge disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;normal disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;screw disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-coordinate (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;disregistry (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dislocation energy terms in eV/angstrom:
Misfit energy =     0.157413973621664
Elastic energy =    -0.25597652593604625
Long-range energy = 0.0
Stress energy =     -0.0
Surface energy =    0.0
Nonlocal energy =   0.0
Total energy =      -0.09856255231438224
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_29_1.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_29_1.png" />
</div>
</div>
<p>Call solve() to run the solver again, using the current disregistry solution as the input disregistry. All other parameters are left unchanged unless they are given.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">pnsolution</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4057
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4455
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4618
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4661
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4990
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 4994
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 5096
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 5143
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 5302
Optimization terminated successfully.
         Current function value: -0.098563
         Iterations: 1
         Function evaluations: 5212
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dislocation energy terms in eV/angstrom:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Misfit energy =    &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">misfit_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Elastic energy =   &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">elastic_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Long-range energy =&#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">longrange_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Stress energy =    &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">stress_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Surface energy =   &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">surface_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nonlocal energy =  &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">nonlocal_energy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total energy =     &#39;</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">total_energy</span><span class="p">())</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;edge disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;normal disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;screw disregistry&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-coordinate (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;disregistry (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dislocation energy terms in eV/angstrom:
Misfit energy =     0.1574689864920074
Elastic energy =    -0.25603162033855004
Long-range energy = 0.0
Stress energy =     -0.0
Surface energy =    0.0
Nonlocal energy =   0.0
Total energy =      -0.09856263384654262
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_32_1.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_32_1.png" />
</div>
</div>
<p>Plot disregistry path on the gamma surface</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pos_to_xy</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">transform</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">E_gsf_surface_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x168802bd198&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_34_1.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_34_1.png" />
</div>
</div>
<p>Plot stacking fault energy as a function of x-coordinate</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sf</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">E_gsf</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">disregistry</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">transform</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnsolution</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">sf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-coordinate (angstrom)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Stacking fault energy (eV/angstrom^2)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_36_0.png" src="../_images/tutorial_04.7._Semidiscrete_variational_Peierls-Nabarro_model_36_0.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to atomman: Semidiscrete variational Peierls-Nabarro model</a><ul>
<li><a class="reference internal" href="#1.-Introduction">1. Introduction</a><ul>
<li><a class="reference internal" href="#1.1.-Theory">1.1. Theory</a><ul>
<li><a class="reference internal" href="#1.1.1.-Disregistry-and-dislocation-density">1.1.1. Disregistry and dislocation density</a></li>
<li><a class="reference internal" href="#1.1.2.-Semidiscrete-variational-Peierls-Nabarro-model">1.1.2. Semidiscrete variational Peierls-Nabarro model</a></li>
<li><a class="reference internal" href="#1.1.3-Elastic-energy">1.1.3 Elastic energy</a></li>
<li><a class="reference internal" href="#1.1.4.-Misfit-energy">1.1.4. Misfit energy</a></li>
<li><a class="reference internal" href="#1.1.5.-Stress-energy">1.1.5. Stress energy</a></li>
<li><a class="reference internal" href="#1.1.6.-Surface-energy">1.1.6. Surface energy</a></li>
<li><a class="reference internal" href="#1.1.7.-Nonlocal-energy">1.1.7. Nonlocal energy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#1.2.-Methodology-overview">1.2. Methodology overview</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Dependent-parameters">2. Dependent parameters</a><ul>
<li><a class="reference internal" href="#2.1.-Define-material-constants">2.1. Define material constants</a></li>
<li><a class="reference internal" href="#2.2.-Get-K_{ij}-values">2.2. Get <span class="math notranslate nohighlight">\(K_{ij}\)</span> values</a></li>
<li><a class="reference internal" href="#2.3.-\gamma-surface">2.3. <span class="math notranslate nohighlight">\(\gamma\)</span> surface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Generate-initial-disregistry">3. Generate initial disregistry</a></li>
<li><a class="reference internal" href="#4.-Solve-SDVPN-model">4. Solve SDVPN model</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="04.6._Gamma_surface_plotting.html"
                        title="previous chapter">Introduction to atomman: Gamma surface plotting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="04.8._Periodic_array_of_dislocations.html"
                        title="next chapter">Introduction to atomman: Periodic array of dislocations</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="04.8._Periodic_array_of_dislocations.html" title="Introduction to atomman: Periodic array of dislocations"
             >next</a> |</li>
        <li class="right" >
          <a href="04.6._Gamma_surface_plotting.html" title="Introduction to atomman: Gamma surface plotting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>