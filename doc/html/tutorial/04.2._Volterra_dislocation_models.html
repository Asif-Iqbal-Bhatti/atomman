
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to atomman: Volterra dislocation models &#8212; atomman 1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to atomman: Dislocation analysis tools" href="04.3._Dislocation_analysis_tools.html" />
    <link rel="prev" title="Introduction to atomman: Point defect generation" href="04.1._Point_defects.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="04.3._Dislocation_analysis_tools.html" title="Introduction to atomman: Dislocation analysis tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="04.1._Point_defects.html" title="Introduction to atomman: Point defect generation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Tutorials</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Introduction-to-atomman:-Volterra-dislocation-models">
<h1>Introduction to atomman: Volterra dislocation models<a class="headerlink" href="#Introduction-to-atomman:-Volterra-dislocation-models" title="Permalink to this headline">¶</a></h1>
<p><strong>Lucas M. Hale</strong>, <a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>, <em>Materials Science and Engineering Division, NIST</em>.</p>
<p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">Disclaimers</a></p>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">¶</a></h2>
<p>This Notebook provides an introduction to the tools in atomman for computing elasticity solutions for straight Volterra dislocations.</p>
<ul class="simple">
<li>atomman.defect.solve_volterra_dislocation() is a wrapper function that returns one of the two classes below based on the supplied elastic constants.</li>
<li>atomman.defect.IsotropicVolterraDislocation class uses the classical analytical equations associated with the isotropic straight dislocation.</li>
<li>atomman.defect.Stroh class solves the Eshelby anisotropic straight dislocation problem using the Stroh (eigenvector) method.</li>
</ul>
<p>Both calculation classes are children of the atomman.defect.VolterraDislocation template class, and therefore provide a similar interface for initialization and obtaining evaluated properties.</p>
<p><strong>Library Imports</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Standard libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>

<span class="c1"># Show atomman version</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomman version =&#39;</span><span class="p">,</span> <span class="n">am</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Show date of Notebook execution</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
atomman version = 1.3.0
Notebook executed on 2019-11-05
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Theory">
<h2>2. Theory<a class="headerlink" href="#2.-Theory" title="Permalink to this headline">¶</a></h2>
<p>Dislocation theory is based on computing and using elasticity solutions of dislocations to define what they look like and how they interact with the surrounding material. The Volterra dislocation model assumes that the discontinuity in the crystal due to the dislocation exists as a line singularity. While this assumption does not hold true in real materials, the Volterra solution is still a good estimate far from the dislocation core. It also provides a useful starting point for developing more
complicated dislocation solutions, and can provide a decent initial guess for constructing atomic dislocation configurations.</p>
<p>For straight dislocations, the solutions are always defined relative to three orthogonal unit vectors <span class="math notranslate nohighlight">\(m_i\)</span>, <span class="math notranslate nohighlight">\(n_i\)</span>, and <span class="math notranslate nohighlight">\(\xi_i\)</span></p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(m_i\)</span> is the direction in the slip plane perpendicular to the line direction.</li>
<li><span class="math notranslate nohighlight">\(n_i\)</span> is the normal of the dislocation’s slip plane.</li>
<li><span class="math notranslate nohighlight">\(\xi_i\)</span> is parallel to the dislocation’s line direction.</li>
</ul>
<p>Based on these three vectors, we can define a Cartesian coordinate system for the dislocation solution with positions, <span class="math notranslate nohighlight">\(x_i\)</span>, given by</p>
<div class="math notranslate nohighlight">
\[x_i = x_1 m_i + x_2 n_i + x_3 \xi_i\]</div>
<div class="section" id="2.1-Isotropic-solution">
<h3>2.1 Isotropic solution<a class="headerlink" href="#2.1-Isotropic-solution" title="Permalink to this headline">¶</a></h3>
<p>Analytical equations for the isotropic dislocation solution can be found in nearly every textbook focused on dislocation theory. The equations used in atomman are close to those found in Elementary Dislocation Theory by Weertman and Weertman, except with flipped signs.</p>
<p>Isotropic elastic constants can be represented using only two independent terms. For dislocation solutions, the two isotropic elastic constants typically used are the shear modulus, <span class="math notranslate nohighlight">\(\mu\)</span>, and the Poisson’s ratio, <span class="math notranslate nohighlight">\(\nu\)</span>.</p>
<p>With a straight dislocation, the solution is independent of the <span class="math notranslate nohighlight">\(x_3\)</span> direction and therefore only depends on <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
<p>The specific isotropic equations used here were selected such that values and periods compare well with the Stroh results.</p>
</div>
<div class="section" id="2.2-Basics-of-the-Stroh-method">
<h3>2.2 Basics of the Stroh method<a class="headerlink" href="#2.2-Basics-of-the-Stroh-method" title="Permalink to this headline">¶</a></h3>
<p>Starting with the fundamental equations of elasticity:</p>
<div class="math notranslate nohighlight">
\[\sigma_{ij} = C_{ijkl} \epsilon_{kl}\]</div>
<div class="math notranslate nohighlight">
\[\epsilon_{ij} = \frac{1}{2} \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}\right)\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial \sigma_{ij}}{\partial x_j} = 0\]</div>
<p>Combining these and taking the solution to be independent of <span class="math notranslate nohighlight">\(x_3\)</span> generates the partial differential equation:</p>
<div class="math notranslate nohighlight">
\[C_{ijkl} \frac{ \partial^2 u_k}{\partial x_j \partial x_l} = 0\]</div>
<p>Solutions of the partial differential equation are of the form</p>
<div class="math notranslate nohighlight">
\[u_k = A_k f(x_1 + p x_2)\]</div>
<p>Values of <span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(p\)</span> can be found by solving</p>
<div class="math notranslate nohighlight">
\[\left[C_{i1k1} + \left(C_{i1k2} + C_{i2k1} \right) p + C_{i2k2} p^2 \right] A_k = 0\]</div>
<p>The determinate expression is a sixth-order polynomial expression resulting in six complex roots, <span class="math notranslate nohighlight">\(p_\alpha\)</span> with <span class="math notranslate nohighlight">\(\alpha\)</span> ranging 1 to 6. There is also one <span class="math notranslate nohighlight">\(A_{k \alpha}\)</span> corresponding to each root.</p>
<p>With the Stroh method for solving the problem, another vector, <span class="math notranslate nohighlight">\(L_i\)</span> is defined for each <span class="math notranslate nohighlight">\(\alpha\)</span> root as</p>
<div class="math notranslate nohighlight">
\[L_{i \alpha} = \left(C_{i2k1} + p_{\alpha} C_{i2k2} \right) A_{k \alpha}\]</div>
<p>and a normalization factor, <span class="math notranslate nohighlight">\(k_{\alpha}\)</span>, as</p>
<div class="math notranslate nohighlight">
\[k_{\alpha} = \frac{1}{2 A_{j \alpha} L_{j \alpha}}\]</div>
<p>Stroh’s method is then to write the problem as an eigenvector problem, which solving gives values for <span class="math notranslate nohighlight">\(p_{\alpha}\)</span>, <span class="math notranslate nohighlight">\(A_{i \alpha}\)</span>, and <span class="math notranslate nohighlight">\(L_{i \alpha}\)</span>. Properties of the dislocation can then be computed with equations that use these solution parameters.</p>
</div>
</div>
<div class="section" id="3.-Initialize/solve">
<h2>3. Initialize/solve<a class="headerlink" href="#3.-Initialize/solve" title="Permalink to this headline">¶</a></h2>
<p>A Volterra dislocation solution can be obtained by either calling the solve_volterra_dislocation() function, or by initializing one of the dislocation solution classes. The two classes also have a solve() method that allows for a new solution to be obtained using the same object. The solve_volterra_dislocation() function, the class initializers, and the class solve methods all accept the same set of parameters.</p>
<p>Parameters</p>
<ul class="simple">
<li><strong>C</strong> (<em>atomman.ElasticConstants</em>) The medium’s elastic constants.</li>
<li><strong>burgers</strong> (<em>array-like object</em>) The dislocation’s Cartesian Burgers vector.</li>
<li><strong>axes</strong> (<em>array-like object, optional</em>) 3x3 set of rotational axes for the system. If given, C and burgers will be transformed using axes.</li>
<li><strong>m</strong> (<em>array-like object, optional</em>) The m Cartesian unit vector for the solution giving the <span class="math notranslate nohighlight">\(x_1\)</span> direction. m, n, and <span class="math notranslate nohighlight">\(\xi\)</span> (dislocation line direction) should be right-hand orthogonal. Default value is [1,0,0] (Cartesian x-axis).</li>
<li><strong>n</strong> (<em>array-like object, optional</em>) The n Cartesian unit vector for the solution giving the <span class="math notranslate nohighlight">\(x_2\)</span> direction. m, n, and <span class="math notranslate nohighlight">\(\xi\)</span> (dislocation line direction) should be right-hand orthogonal. Default value is [0,1,0] (Cartesian y-axis).</li>
<li><strong>tol</strong> (<em>float</em>) Tolerance parameter used to round off near-zero values. Default value is 1e-8.</li>
</ul>
<div class="section" id="3.1-Fcc-dislocation-parameters">
<h3>3.1 Fcc dislocation parameters<a class="headerlink" href="#3.1-Fcc-dislocation-parameters" title="Permalink to this headline">¶</a></h3>
<p>These are parameters for the fcc <span class="math notranslate nohighlight">\(\frac{a}{2}&lt;10\bar{1}&gt;{111}\)</span> edge dislocation using the default <span class="math notranslate nohighlight">\(m=[100]\)</span>, <span class="math notranslate nohighlight">\(n=[010]\)</span> orientation. <strong>Note</strong>: alternate orientations may be preferred based on the matrix material’s crystal structure and the simulation software that will be used. See Section #6 for discussion on more general cases.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Cu fcc lattice constant</span>
<span class="n">alat</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">3.6</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>

<span class="c1"># burgers = a/2 &lt;1 0 -1&gt;</span>
<span class="n">burgers</span> <span class="o">=</span> <span class="n">alat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Define system orientation axes for edge dislocation:</span>
<span class="c1"># xaxis aligned with m, i.e. edge component</span>
<span class="c1"># yaxis aligned with n, i.e. slip plane normal</span>
<span class="c1"># zaxis aligned with ξ, i.e. screw component</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">yaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">zaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.2-Isotropic-example">
<h3>3.2 Isotropic example<a class="headerlink" href="#3.2-Isotropic-example" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rough isotropic values for Cu</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">Poisson</span> <span class="o">=</span> <span class="mf">0.34</span>

<span class="c1"># Build ElasticConstants object (standard crystal reference)</span>
<span class="n">C_iso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">ElasticConstants</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="n">Poisson</span><span class="p">)</span>

<span class="c1"># Solve dislocation</span>
<span class="n">iso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">solve_volterra_dislocation</span><span class="p">(</span><span class="n">C_iso</span><span class="p">,</span> <span class="n">burgers</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Show class and solution parameters</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iso is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.mu -&gt; {uc.get_in_units(iso.mu, &quot;GPa&quot;):.3f} GPa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.nu -&gt; </span><span class="si">{iso.nu}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso is:
&lt;atomman.defect.IsotropicVolterraDislocation.IsotropicVolterraDislocation object at 0x000001D366235198&gt;
iso.mu -&gt; 48.507 GPa
iso.nu -&gt; 0.34
</pre></div></div>
</div>
</div>
<div class="section" id="3.3-Anisotropic-example">
<h3>3.3 Anisotropic example<a class="headerlink" href="#3.3-Anisotropic-example" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rough anisotropic values for Cu</span>
<span class="n">C11</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mi">169</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">C12</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
<span class="n">C44</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">75.4</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>

<span class="c1"># Build ElasticConstants object (standard crystal reference)</span>
<span class="n">C_aniso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">ElasticConstants</span><span class="p">(</span><span class="n">C11</span><span class="o">=</span><span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="o">=</span><span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="o">=</span><span class="n">C44</span><span class="p">)</span>

<span class="c1"># Solve Stroh method for conditions</span>
<span class="n">aniso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">solve_volterra_dislocation</span><span class="p">(</span><span class="n">C_aniso</span><span class="p">,</span> <span class="n">burgers</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Show class and solution parameters</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aniso</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.p -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.A -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.L -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.k -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
aniso is:
&lt;atomman.defect.Stroh.Stroh object at 0x000001D36A88F5F8&gt;

aniso.p -&gt;
[-5.743e-01+1.481j -5.743e-01-1.481j  5.743e-01+1.481j  5.743e-01-1.481j
  4.930e-32+0.394j  4.930e-32-0.394j]

aniso.A -&gt;
[[-4.925e-01+2.927e-01j -1.867e-01-9.776e-02j  6.672e-01+0.000e+00j]
 [-4.925e-01-2.927e-01j -1.867e-01+9.776e-02j  6.672e-01-0.000e+00j]
 [ 4.925e-01+2.927e-01j -1.867e-01+9.776e-02j  6.672e-01+0.000e+00j]
 [ 4.925e-01-2.927e-01j -1.867e-01-9.776e-02j  6.672e-01-0.000e+00j]
 [ 3.134e-16-1.473e-01j  7.891e-01+0.000e+00j  4.278e-01-1.446e-16j]
 [ 3.134e-16+1.473e-01j  7.891e-01-0.000e+00j  4.278e-01+1.446e-16j]]

aniso.L -&gt;
[[ 1.878e-01+2.534e-01j -1.060e-01+1.679e-01j  2.238e-02-2.069e-01j]
 [ 1.878e-01-2.534e-01j -1.060e-01-1.679e-01j  2.238e-02+2.069e-01j]
 [ 1.878e-01-2.534e-01j  1.060e-01+1.679e-01j -2.238e-02-2.069e-01j]
 [ 1.878e-01+2.534e-01j  1.060e-01-1.679e-01j -2.238e-02+2.069e-01j]
 [-1.504e-01-8.063e-17j  5.417e-17-3.818e-01j -8.178e-17-6.540e-02j]
 [-1.504e-01+8.063e-17j  5.417e-17+3.818e-01j -8.178e-17+6.540e-02j]]

aniso.k -&gt;
[[ 1.878e-01+2.534e-01j -1.060e-01+1.679e-01j  2.238e-02-2.069e-01j]
 [ 1.878e-01-2.534e-01j -1.060e-01-1.679e-01j  2.238e-02+2.069e-01j]
 [ 1.878e-01-2.534e-01j  1.060e-01+1.679e-01j -2.238e-02-2.069e-01j]
 [ 1.878e-01+2.534e-01j  1.060e-01-1.679e-01j -2.238e-02+2.069e-01j]
 [-1.504e-01-8.063e-17j  5.417e-17-3.818e-01j -8.178e-17-6.540e-02j]
 [-1.504e-01+8.063e-17j  5.417e-17+3.818e-01j -8.178e-17+6.540e-02j]]

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.-Derived-properties">
<h2>4. Derived properties<a class="headerlink" href="#4.-Derived-properties" title="Permalink to this headline">¶</a></h2>
<p>Different properties of the solution can be derived from the solution parameters and obtained as other attributes of the class.</p>
<div class="section" id="4.1-Energy-coefficient-tensor,-K_tensor">
<h3>4.1 Energy coefficient tensor, K_tensor<a class="headerlink" href="#4.1-Energy-coefficient-tensor,-K_tensor" title="Permalink to this headline">¶</a></h3>
<p>The energy coefficient tensor is a property of the solution that is useful for dislocation stress and energy calculations. It only depends on the elastic constants and the orientation.</p>
<p><strong>Caution</strong>: <span class="math notranslate nohighlight">\(K_{ij}\)</span> is defined differently by different authors and may vary by multiplicative factors. Here, it is taken such that the isotropic screw component is the shear modulus, <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<div class="section" id="4.1.1-Isotropic">
<h4>4.1.1 Isotropic<a class="headerlink" href="#4.1.1-Isotropic" title="Permalink to this headline">¶</a></h4>
<p>In the isotropic case, the only non-zero components (in the dislocation orientation) are</p>
<div class="math notranslate nohighlight">
\[K_{11}^{iso} = K_{22}^{iso} = K_{edge}^{iso} = \frac{\mu}{1 - \nu}\]</div>
<div class="math notranslate nohighlight">
\[K_{33}^{iso} = K_{screw}^{iso} = \mu\]</div>
</div>
<div class="section" id="4.1.2-Anisotropic">
<h4>4.1.2 Anisotropic<a class="headerlink" href="#4.1.2-Anisotropic" title="Permalink to this headline">¶</a></h4>
<p>The tensor can be obtained from the Stroh solution parameters as</p>
<div class="math notranslate nohighlight">
\[K_{jl} = i \sum_{\alpha} \pm k_{\alpha} L_{j \alpha} L_{l \alpha}\]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> is the imaginary unit and the <span class="math notranslate nohighlight">\(\pm\)</span> sense alternates for even/odd values of <span class="math notranslate nohighlight">\(\alpha\)</span> (the six partial solutions are three pairs of complex conjugates).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iso.K_tensor (in GPa) -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">iso</span><span class="o">.</span><span class="n">K_tensor</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.K_tensor (in GPa) -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">K_tensor</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso.K_tensor (in GPa) -&gt;
[[73.496  0.     0.   ]
 [ 0.    73.496  0.   ]
 [ 0.     0.    48.507]]

aniso.K_tensor (in GPa) -&gt;
[[74.096  0.     0.   ]
 [ 0.    74.933 -8.628]
 [ 0.    -8.628 44.217]]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.2-Energy-coefficient,-K_coeff">
<h3>4.2 Energy coefficient, K_coeff<a class="headerlink" href="#4.2-Energy-coefficient,-K_coeff" title="Permalink to this headline">¶</a></h3>
<p>The energy coefficient, <span class="math notranslate nohighlight">\(K\)</span>, is a dislocation-specific coefficient found in expressions for a dislocation’s self-energy</p>
<div class="math notranslate nohighlight">
\[\frac{W}{l} = \frac{K b^2}{4 \pi} \ln{ \left( \frac{R}{r_0} \right)},\]</div>
<p>where <span class="math notranslate nohighlight">\(b\)</span> is the magnitude of <span class="math notranslate nohighlight">\(b_i\)</span>, and <span class="math notranslate nohighlight">\(r_0\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the inner and outer radii of a cylindircal ring around the dislocation. The energy coefficient can be computed from the energy coefficent tensor and burgers vector</p>
<div class="math notranslate nohighlight">
\[K = \frac{b_i K_{ij} b_j} {b_k b_k}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note values are same as K11 component above due to pure edge dislocation</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.K_coeff -&gt;   {uc.get_in_units(iso.K_coeff, &quot;GPa&quot;):.3f} GPa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;aniso.K_coeff -&gt; {uc.get_in_units(aniso.K_coeff, &quot;GPa&quot;):.3f} GPa&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso.K_coeff -&gt;   73.496 GPa
aniso.K_coeff -&gt; 74.096 GPa
</pre></div></div>
</div>
</div>
<div class="section" id="4.3-Pre-logarithmic-factor,-preln">
<h3>4.3 Pre-logarithmic factor, preln<a class="headerlink" href="#4.3-Pre-logarithmic-factor,-preln" title="Permalink to this headline">¶</a></h3>
<p>Alternatively, the self-energy expression can be represented as</p>
<div class="math notranslate nohighlight">
\[\frac{W}{l} = a \ln{ \left( \frac{R}{r_0} \right)},\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is referred to as the pre-logarithmic energy factor and is in units of energy/length. Related to <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(K_{ij}\)</span>,</p>
<div class="math notranslate nohighlight">
\[a = \frac{b_i K_{ij} b_j}{4 \pi} = \frac{K b^2}{4 \pi}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.preln -&gt;   {uc.get_in_units(iso.preln, &quot;eV/Å&quot;):f} eV/Å&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;aniso.preln -&gt; {uc.get_in_units(aniso.preln, &quot;eV/Å&quot;):f} eV/Å&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso.preln -&gt;   0.236548 eV/Å
aniso.preln -&gt; 0.238480 eV/Å
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="5.-Position-dependent-calculations">
<h2>5. Position-dependent calculations<a class="headerlink" href="#5.-Position-dependent-calculations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="5.1.-Setup">
<h3>5.1. Setup<a class="headerlink" href="#5.1.-Setup" title="Permalink to this headline">¶</a></h3>
<p>Create an fcc Cu demonstration unit cell</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">box</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">alat</span><span class="p">)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]])</span>

<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span>
                  <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span>
                  <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 3.600,  0.000,  0.000]
bvect =  [ 0.000,  3.600,  0.000]
cvect =  [ 0.000,  0.000,  3.600]
origin = [ 0.000,  0.000,  0.000]
natoms = 4
natypes = 1
symbols = (None,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   0.000 |   0.000 |   0.000
      1 |       1 |   1.800 |   1.800 |   0.000
      2 |       1 |   1.800 |   0.000 |   1.800
      3 |       1 |   0.000 |   1.800 |   1.800
</pre></div></div>
</div>
<p>Use ucell to generate system</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create system by rotating ucell to coincide with dislocation solution</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">rotate</span><span class="p">([</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">])</span>

<span class="c1"># Shift all atomic positions by half {111} planar spacing to avoid atoms at y=0</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="n">alat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">wrap</span><span class="p">()</span>

<span class="c1"># Note equal +- mults along avect, bvect directions</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">supersize</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;system.natoms -&gt;&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
system.natoms -&gt; 864
</pre></div></div>
</div>
<p>Plot xy cross section of atoms</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot original positions of atoms in system</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_32_0.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_32_0.png" />
</div>
</div>
</div>
<div class="section" id="5.2-Derrived-coordinates">
<h3>5.2 Derrived coordinates<a class="headerlink" href="#5.2-Derrived-coordinates" title="Permalink to this headline">¶</a></h3>
<p>The computed properties using both methods rely on derrived coordinates. For validation/verification, these derrived coordinates can be directly retrieved.</p>
<div class="section" id="5.2.1-IsotropicVolterraDislocation.theta()">
<h4>5.2.1 IsotropicVolterraDislocation.theta()<a class="headerlink" href="#5.2.1-IsotropicVolterraDislocation.theta()" title="Permalink to this headline">¶</a></h4>
<p>Certain properties of the isotropic dislocation are better represented in radial coordinates rather than Cartesian coordinates. In particular, the isotropic equations used here depend on the radial angle coordinate, <span class="math notranslate nohighlight">\(\theta\)</span></p>
<div class="math notranslate nohighlight">
\[\theta=\tan^{-1} (x_2/x_1),\]</div>
<p>which is taken to range from <span class="math notranslate nohighlight">\(-\pi\)</span> to <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute theta for all pos and show min/max values</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">iso</span><span class="o">.</span><span class="n">theta</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;min(theta) -&gt; {np.min(theta):f}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;max(theta) -&gt; {np.max(theta):f}&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
min(theta) -&gt; -3.073656
max(theta) -&gt; 3.073656
</pre></div></div>
</div>
</div>
<div class="section" id="5.2.2-Stroh.eta()">
<h4>5.2.2 Stroh.eta()<a class="headerlink" href="#5.2.2-Stroh.eta()" title="Permalink to this headline">¶</a></h4>
<p>The position-dependent Stroh properties rely on an imaginary coordinate <span class="math notranslate nohighlight">\(\eta\)</span> that combines <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> using the computed eigenvalues <span class="math notranslate nohighlight">\(p_{\alpha}\)</span></p>
<div class="math notranslate nohighlight">
\[\eta_{\alpha} = x_1 + p_{\alpha} x_2\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute eta for test position [1, 2, 3]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.eta([1,2,3]) (in Å) -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">eta</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="s1">&#39;Å&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
aniso.eta([1,2,3]) (in Å) -&gt;
[[-0.149+2.961j -0.149-2.961j  2.149+2.961j  2.149-2.961j  1.   +0.788j
   1.   -0.788j]]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="5.3-displacements">
<h3>5.3 displacements<a class="headerlink" href="#5.3-displacements" title="Permalink to this headline">¶</a></h3>
<p>Position-based displacements associated with the elastic solution can be calculated using either model. These can be applied to atomic configurations to generate “initial” dislocation configurations.</p>
<div class="section" id="5.3.1-Isotropic-equations">
<h4>5.3.1 Isotropic equations<a class="headerlink" href="#5.3.1-Isotropic-equations" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[u_1 = \frac{b_1}{2 \pi} \left[ \theta + \frac{x_1x_2}{2 (1 - \nu) (x_1^2 + x_2^2)} \right]\]</div>
<div class="math notranslate nohighlight">
\[u_2 = \frac{b_1}{2 \pi} \left[ -\frac{1 - 2 \nu} {4 (1 - \nu)} \ln(x_1^2 + x_2^2)
                          + \frac{y^2} {2 (1 - \nu) (x^2 + y^2)} \right]\]</div>
<div class="math notranslate nohighlight">
\[u_3 = \frac{b_3}{2 \pi} \theta\]</div>
</div>
<div class="section" id="5.3.2-Anisotropic-equations">
<h4>5.3.2 Anisotropic equations<a class="headerlink" href="#5.3.2-Anisotropic-equations" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[u_j = \frac{1}{2 \pi i} \sum_{\alpha}  \pm k_{\alpha} A_{j \alpha} (L_{l \alpha} b_l) \ln{\eta_{\alpha}}\]</div>
<p>Select the solution to use here and below</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">aniso</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute displacements for all positions</span>
<span class="n">disp</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>

<span class="c1"># Apply displacements to positions</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span>

<span class="c1"># plot new positions of atoms in system</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_40_0.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_40_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="5.3-stress">
<h3>5.3 stress<a class="headerlink" href="#5.3-stress" title="Permalink to this headline">¶</a></h3>
<p>The stress state associated with the elastic solution can also be calculated at a given position for both models</p>
<div class="section" id="5.3.1-Isotropic-equations">
<h4>5.3.1 Isotropic equations<a class="headerlink" href="#5.3.1-Isotropic-equations" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[\sigma_{11} = -\frac{\mu b_1}{2 \pi (1 - \nu)} \frac{x_2 (3 x_1^2 + x_2^2)} { (x_1^2 + x_2^2)^2}\]</div>
<div class="math notranslate nohighlight">
\[\sigma_{22} = \frac{\mu b_1}{2 \pi (1 - \nu)} \frac{x_2 (x_1^2 - x_2^2)} { (x_1^2 + x_2^2)^2}\]</div>
<div class="math notranslate nohighlight">
\[\sigma_{33} = \nu(\sigma_{11} + \sigma_{22})\]</div>
<div class="math notranslate nohighlight">
\[\sigma_{12} = \frac{\mu b_1}{2 \pi (1 - \nu)} \frac{x_1(x_1^2 - x_2^2)) }{ (x_1^2 + x_2^2)^2}\]</div>
<div class="math notranslate nohighlight">
\[\sigma_{13} =-\frac{\mu b_3}{2 \pi} \frac{x_2}{(x_1^2 + x_2^2)}\]</div>
<div class="math notranslate nohighlight">
\[\sigma_{23} = \frac{\mu b_3}{2 \pi} \frac{x_1}{(x_1^2 + x_2^2)}\]</div>
</div>
<div class="section" id="5.3.2-Anisotropic-equations">
<h4>5.3.2 Anisotropic equations<a class="headerlink" href="#5.3.2-Anisotropic-equations" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[\sigma_{ij} = \frac{1}{2 \pi i} \sum_{\alpha}  \pm k_{\alpha} C_{ijkl}[m_l + p_{\alpha} n_l] A_{k \alpha} (L_{m \alpha} b_m) \frac{1}{\eta_{\alpha}}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate stress state at each atomic position</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Dirty plots of stress components</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_11:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_22:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_33:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_12:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_13:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_23:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_11:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_1.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_22:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_3.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_33:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_5.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_12:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_7.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_13:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_9.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_23:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_43_11.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_43_11.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="6.-General-case-considerations">
<h2>6. General case considerations<a class="headerlink" href="#6.-General-case-considerations" title="Permalink to this headline">¶</a></h2>
<p>Properly building atomistic systems with dislocations using the Stroh method requires careful considerations regarding the system orientation. This is complicated by the need to think in terms of multiple axes systems</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\([hkl]\)</span> crystal vectors are commonly used to define dislocation types and slip planes. These vectors are taken relative to the box vectors of a unit cell in a standard reference frame.</li>
<li>The atomistic system’s orientation is defined by specifying <span class="math notranslate nohighlight">\([hkl]\)</span> crystal vectors to coincide with the system’s <span class="math notranslate nohighlight">\(a_i\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span>, <span class="math notranslate nohighlight">\(c_i\)</span> box vectors.</li>
<li>The atomic positions within the atomistic system are represented with Cartesian <span class="math notranslate nohighlight">\(x'_i\)</span> coordinates.</li>
<li>The elastic solution is defined for Cartesian <span class="math notranslate nohighlight">\(x_i\)</span> coordinates, where <span class="math notranslate nohighlight">\(x_2\)</span> is normal to the slip plane and <span class="math notranslate nohighlight">\(x_3\)</span> is parallel to the dislocation line.</li>
</ul>
<p>As the latter two are both Cartesian, <span class="math notranslate nohighlight">\(x_i\)</span> values are easily obtained from <span class="math notranslate nohighlight">\(x'_i\)</span> using transformation unit vectors <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(n_i\)</span></p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(x_1 = m_i x'_i\)</span></li>
<li><span class="math notranslate nohighlight">\(x_2 = n_i x'_i\)</span></li>
<li><span class="math notranslate nohighlight">\(x_3\)</span> values not needed as the elastic solution is invariant in that direction.</li>
</ul>
<p>Depending on the crystal structure and dislocation type, it is not always possible to construct a system with orthogonal box vectors. This means that the <span class="math notranslate nohighlight">\(a_i\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span>, <span class="math notranslate nohighlight">\(c_i\)</span> box vectors will not necessarily align with the <span class="math notranslate nohighlight">\(x'_i\)</span> axes. For this general case, the following requirements and choices can help with orientation decisions</p>
<ul class="simple">
<li>The dislocation’s line direction must be parallel to one of the box vectors for the dislocation to remain infinitely straight.</li>
<li>For convenience, each of the elastic solution’s <span class="math notranslate nohighlight">\(x_i\)</span>-axes should map to one of the atomic system’s <span class="math notranslate nohighlight">\(x'_i\)</span>-axes. This is accomplished if both the dislocation line and the slip plane normal are oriented along <span class="math notranslate nohighlight">\(x'_i\)</span>-axes.</li>
</ul>
<p>With LAMMPS-compatible system boxes</p>
<ul class="simple">
<li>The <span class="math notranslate nohighlight">\(a_i\)</span> box vector is always aligned with the <span class="math notranslate nohighlight">\(x'_1\)</span>-axis, therefore the dislocation line should be parallel to the <span class="math notranslate nohighlight">\(a_i\)</span> vector / <span class="math notranslate nohighlight">\(x'_1\)</span>-axis.</li>
<li>The <span class="math notranslate nohighlight">\(a_i\)</span> and <span class="math notranslate nohighlight">\(b_i\)</span> box vectors have no component in the <span class="math notranslate nohighlight">\(x'_3\)</span> direction, i.e.&nbsp;the plane containing both <span class="math notranslate nohighlight">\(a_i\)</span> and <span class="math notranslate nohighlight">\(b_i\)</span> is normal to the <span class="math notranslate nohighlight">\(x'_3\)</span>-axis. The slip plane normal can then be taken as parallel to the <span class="math notranslate nohighlight">\(x'_3\)</span>-axis.</li>
<li>Related to the elastic solution, this makes <span class="math notranslate nohighlight">\(x_1\)</span> parallel to the <span class="math notranslate nohighlight">\(x'_2\)</span>-axis, <span class="math notranslate nohighlight">\(x_2\)</span> parallel to the <span class="math notranslate nohighlight">\(x'_3\)</span>-axis, and <span class="math notranslate nohighlight">\(x_3\)</span> parallel to the <span class="math notranslate nohighlight">\(x'_1\)</span>-axis. The corresponding <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(n_i\)</span> values are<ul>
<li><span class="math notranslate nohighlight">\(m_i = [0, 1, 0]\)</span></li>
<li><span class="math notranslate nohighlight">\(n_i = [0, 0, 1]\)</span></li>
</ul>
</li>
</ul>
<p>Redefine earlier problem, but in LAMMPS-preferred setting for general dislocations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set m, n vectors</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Define system orientation axes for edge dislocation:</span>
<span class="c1"># xaxis aligned with ξ, i.e. screw component</span>
<span class="c1"># yaxis aligned with m, i.e. edge component</span>
<span class="c1"># zaxis aligned with n, i.e. slip plane normal</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">yaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">zaxis</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Get iso and aniso solutions for new orientation</span>
<span class="n">iso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">solve_volterra_dislocation</span><span class="p">(</span><span class="n">C_iso</span><span class="p">,</span> <span class="n">burgers</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">aniso</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">defect</span><span class="o">.</span><span class="n">solve_volterra_dislocation</span><span class="p">(</span><span class="n">C_aniso</span><span class="p">,</span> <span class="n">burgers</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Check that derived values are consistent (K_tensor rotated)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iso.K_tensor (in GPa) -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">iso</span><span class="o">.</span><span class="n">K_tensor</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aniso.K_tensor (in GPa) -&gt;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">aniso</span><span class="o">.</span><span class="n">K_tensor</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.K_coeff -&gt;   {uc.get_in_units(iso.K_coeff, &quot;GPa&quot;):.3f} GPa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;aniso.K_coeff -&gt; {uc.get_in_units(aniso.K_coeff, &quot;GPa&quot;):.3f} GPa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># preln is considered in units of energy/length</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;iso.preln -&gt;   {uc.get_in_units(iso.preln, &quot;eV/Å&quot;):f} eV/Å&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;aniso.preln -&gt; {uc.get_in_units(aniso.preln, &quot;eV/Å&quot;):f} eV/Å&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso.K_tensor (in GPa) -&gt;
[[48.507  0.     0.   ]
 [ 0.    73.496  0.   ]
 [ 0.     0.    73.496]]

aniso.K_tensor (in GPa) -&gt;
[[44.217  0.    -8.628]
 [ 0.    74.096  0.   ]
 [-8.628  0.    74.933]]

iso.K_coeff -&gt;   73.496 GPa
aniso.K_coeff -&gt; 74.096 GPa

iso.preln -&gt;   0.236548 eV/Å
aniso.preln -&gt; 0.238480 eV/Å
</pre></div></div>
</div>
<p>Generate an atomic system that is properly rotated as well</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create system by rotating ucell to coincide with dislocation solution</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">rotate</span><span class="p">([</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">zaxis</span><span class="p">])</span>

<span class="c1"># Shift all atomic positions so y=0 and z=0 are between atomic planes</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="n">alat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">wrap</span><span class="p">()</span>

<span class="c1"># Note equal +- mults along avect, bvect directions</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">supersize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;system.natoms -&gt;&#39;</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
system.natoms -&gt; 864
</pre></div></div>
</div>
<p>Show that resulting displacements are the same as above, just with plotting y, z coordinates instead of x, y coordinates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot original positions of atoms in system</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_52_0.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_52_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">iso</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute displacements for all positions</span>
<span class="n">disp</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>

<span class="c1"># Apply displacements to positions</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span>

<span class="c1"># Calculate stress state at each atomic position</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>

<span class="c1"># Dirty plots of displaced atoms and stress component</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stress_11:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">stress</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stress_11:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_04.2._Volterra_dislocation_models_54_1.png" src="../_images/tutorial_04.2._Volterra_dislocation_models_54_1.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to atomman: Volterra dislocation models</a><ul>
<li><a class="reference internal" href="#1.-Introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#2.-Theory">2. Theory</a><ul>
<li><a class="reference internal" href="#2.1-Isotropic-solution">2.1 Isotropic solution</a></li>
<li><a class="reference internal" href="#2.2-Basics-of-the-Stroh-method">2.2 Basics of the Stroh method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Initialize/solve">3. Initialize/solve</a><ul>
<li><a class="reference internal" href="#3.1-Fcc-dislocation-parameters">3.1 Fcc dislocation parameters</a></li>
<li><a class="reference internal" href="#3.2-Isotropic-example">3.2 Isotropic example</a></li>
<li><a class="reference internal" href="#3.3-Anisotropic-example">3.3 Anisotropic example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Derived-properties">4. Derived properties</a><ul>
<li><a class="reference internal" href="#4.1-Energy-coefficient-tensor,-K_tensor">4.1 Energy coefficient tensor, K_tensor</a><ul>
<li><a class="reference internal" href="#4.1.1-Isotropic">4.1.1 Isotropic</a></li>
<li><a class="reference internal" href="#4.1.2-Anisotropic">4.1.2 Anisotropic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.2-Energy-coefficient,-K_coeff">4.2 Energy coefficient, K_coeff</a></li>
<li><a class="reference internal" href="#4.3-Pre-logarithmic-factor,-preln">4.3 Pre-logarithmic factor, preln</a></li>
</ul>
</li>
<li><a class="reference internal" href="#5.-Position-dependent-calculations">5. Position-dependent calculations</a><ul>
<li><a class="reference internal" href="#5.1.-Setup">5.1. Setup</a></li>
<li><a class="reference internal" href="#5.2-Derrived-coordinates">5.2 Derrived coordinates</a><ul>
<li><a class="reference internal" href="#5.2.1-IsotropicVolterraDislocation.theta()">5.2.1 IsotropicVolterraDislocation.theta()</a></li>
<li><a class="reference internal" href="#5.2.2-Stroh.eta()">5.2.2 Stroh.eta()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#5.3-displacements">5.3 displacements</a><ul>
<li><a class="reference internal" href="#5.3.1-Isotropic-equations">5.3.1 Isotropic equations</a></li>
<li><a class="reference internal" href="#5.3.2-Anisotropic-equations">5.3.2 Anisotropic equations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#5.3-stress">5.3 stress</a><ul>
<li><a class="reference internal" href="#5.3.1-Isotropic-equations">5.3.1 Isotropic equations</a></li>
<li><a class="reference internal" href="#5.3.2-Anisotropic-equations">5.3.2 Anisotropic equations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#6.-General-case-considerations">6. General case considerations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="04.1._Point_defects.html"
                        title="previous chapter">Introduction to atomman: Point defect generation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="04.3._Dislocation_analysis_tools.html"
                        title="next chapter">Introduction to atomman: Dislocation analysis tools</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="04.3._Dislocation_analysis_tools.html" title="Introduction to atomman: Dislocation analysis tools"
             >next</a> |</li>
        <li class="right" >
          <a href="04.1._Point_defects.html" title="Introduction to atomman: Point defect generation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">atomman 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Tutorials</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>